define("data/ajax",["leaflet","core/namespace"],function(t){t.ICT.Ajax=t.Class.extend({_timeout:6e4,_defs:[],initialize:function(){this._timeout=6e4,this._defs=[]},getDefs:function(){return this._defs},abort:function(){for(var t=0,e=this._defs.length;e>t;t++)this._defs[t]&&this._defs[t].abort();this._defs=[]},get:function(t,e,r,o,s,n){return n||(n=this.error),this._isCrossDomain(t)?this.request(t,e,r,o,s,n):this._request({url:t,data:e,async:r,dataType:"json",type:"GET",context:o,contentType:"application/x-www-form-urlencoded;",success:s,error:n})},post:function(t,e,r,o,s,n){return n||(n=this.error),this._isCrossDomain(t)&&(t=Project_ParamConfig.defaultAjaxProxy+"?"+t),this._request({url:t,data:e,async:r,dataType:"json",type:"POST",context:o,contentType:"application/x-www-form-urlencoded;",success:s,error:n})},put:function(t,e,r,o,s,n){return n||(n=this.error),$.ajax({url:t,data:e,async:r,context:o,dataType:"text",type:"PUT",timeout:this._timeout,cache:!1,success:s,error:n})},request:function(t,e,r,o,s,n){return n||(n=this.error),$.isEmptyObject(e)||(t=t+"?"+$.param(e)),this._request({url:t,async:r,context:o,dataType:"jsonp",type:"GET",contentType:"application/x-www-form-urlencoded;",success:s,error:n,timeout:this._timeout})},_removeDef:function(t){for(var e=0;e<this._defs.length;e++)this._defs[e]===t&&this._defs.splice(e,1)},_isSamePort:function(t){var e=window.location.port,r=t.split("/")[2].split(":")[1];return e===r},_isCrossDomain:function(t){if(-1==t.indexOf("http"))return!1;if(!this._isSamePort(t))return!0;var e=window.location.hostname,r=t.split("/")[2].split(":")[0];return e.toLowerCase()!==r.toLowerCase()},_request:function(t){var e;try{var r=this;t.error||(t.error=r.error),e=$.ajax({url:t.url,data:t.data,dataType:t.dataType,type:t.type,contentType:"application/x-www-form-urlencoded",async:t.async,cache:!1,context:t.context,timeout:r._timeout}),e.then(function(o){r._removeDef(e);try{"text"!==t.type&&"string"==typeof o&&(o=$.parseJSON(o))}catch(s){console.log(s.message)}t.success.call(t.context,o)},function(o){r._removeDef(e),t.error.call(t.context,o)}),this._defs.push(e)}catch(o){console.log(o.message)}return e},error:function(t){console.log(t.message)}})});