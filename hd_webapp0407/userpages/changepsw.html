<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>修改密码(暂不使用单独页面)</title>
    <link rel="stylesheet" type="text/css" href="../library/bootstrap/css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="../library/bootstrap/css/bootstrap-theme.css">
    <link rel="stylesheet" href="../themes/css/func.user.css"/>
    <script type="text/javascript" src="../library/jquery/jquery.min.js"></script>
    <script type="text/javascript" src="../project/project.config.js"></script>
    <style>
        .input_font{display:inline-block; width:80px;font-size: 16px;text-align:left;  }
        .input{width:210px;  height: 35px;border-radius: 4px; }
        .btn_div{border-radius:4px;border: 0;height:35px;width:145px;font-size:18px;color: #fff;letter-spacing:15px;  background-color: #188bff;  }
        .btn_div:hover{background-color: #024191;  }
        .error{  margin: 0;  height:25px;  line-height: 30px;  font-size: 14px;  color: #dedede;  text-align: left;  }
    </style>

</head>
<body>
    <div class="container">
        <div style="padding: 20px 0;">
            <img src="../themes/images/userLogin/login_logo.jpg" style="vertical-align: bottom" alt=""/>
            <span class="title_font">修改密码</span>
        </div>
    </div>
    <div class="content">
        <div class="content_div">
            <div class="input_div">
                <span class="input_font">原密码:</span>
                <input type="password" class="input origpsw" autocomplete="off"/>
                <span class="input_font"></span><span class="error error_orig"></span>  <!--存放错误提醒-->
            </div>
            <div class="input_div">
                <span class="input_font">新密码:</span>
                <input type="password" class="input newpsw"  autocomplete="off"/>
                <span class="input_font"></span><span class="error error_new"></span> <!--存放错误提醒-->
            </div>
            <div class="input_div">
                <span class="input_font">确认密码:</span>
                <input type="password" class="input confirmpsw"  autocomplete="off"/>
                <span class="input_font"></span><span class="error error_confirm"></span>  <!--存放错误提醒-->
            </div>
            <div class="input_div">
                <button class="btn_div btn_ok">确认</button>
                <button class="btn_div btn_cancel">取消</button>
            </div>
        </div>
    </div>
    <!-- 修改密码业务逻辑 -->
    <script type="text/javascript">
    var $origpsw = $(".origpsw");
    var $newpsw = $(".newpsw");
    var $confirmpsw = $(".confirmpsw");
    var $error = $("error");
    
    $(".btn_ok").on("click",function(){
         $error.val('');
         var origpsw  = $.trim($origpsw.val());
         var newpsw = $.trim($newpsw.val());
         var confirmpsw = $.trim($confirmpsw.val());
         if(origpsw === ''){
            $(".error_orig").val('原始密码不能为空！');
            $origpsw.focus();
            return;
         }
         if(newpsw === ''){
            $("error_new").val('新密码不能为空！');
            $newpsw.focus();
            return;
         }
         if(newpsw !== confirmpsw){
            $("error_confirm").val('两次密码输入不一致！');
            return;
         }

         var url = Project_ParamConfig.userConfig.modifypswUrl;
         var userInfo = window.sessionStorage.getItem("userInfo");
         if(userInfo) {
            userInfo = JSON.parse(userInfo);
         }
         var data = {
             id:userInfo.id,
             oldPassWord:origpsw,
             newPassWord:newpsw
         };
         $.ajax({
            url:url,
            data:data,
            method:'POST',
            dataType:'json',
            success:function(res){
                if(res.state !==1){
                    $("error_confirm").val(res.msg.result);
                }else{
                    
                }
            },
            error:function(error){

            }
         });
    });

    $(".btn_cancel").on("click",function(){
        window.location.href = "../index.html";
    });            
    </script>
</body>
</html>