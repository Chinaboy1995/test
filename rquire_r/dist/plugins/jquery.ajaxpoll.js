define("plugins/ajaxpoll",["jquery"],function(){(function(e){var t,n,r,i,s=function(o){function a(){return document.hidden||document.mozHidden||document.msHidden||document.webkitHidden||!1}function f(e){var t=a()?f:s;n&&clearTimeout(n),n=setTimeout(function(){t(e)},1e3)}function l(e){return Math.round(Math.random()*500*Math.pow(2,e))}function c(e,t){var o=a()?f:s;n&&clearTimeout(n);if(i>e.pollMaxFailedAttempts){console.error("Polling terminated due to exceeding max failed attempts...");return}if(e.pollLoops!==-1){r+=1;if(r>=e.pollLoops)return}t&&(n=setTimeout(function(){o(e)},t))}var u=e.ajax;o.pollDelay=o.pollDelay||6e4,o.pollLoops=o.pollLoops||-1,o.pollMaxFailedAttempts=o.pollMaxFailedAttempts||10,r=r||0,i=i||0,t=u(o),typeof o.pollDone=="function"&&t.done(o.pollDone),typeof o.pollFail=="function"&&t.fail(o.pollFail),t.done(function(){i=0,c(o,o.pollDelay)}),t.fail(function(){i++,c(o,l(i))})};e.extend({poll:s})})(jQuery)});