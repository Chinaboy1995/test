/*
 Leaflet 1.0.0, a JS library for interactive maps. http://leafletjs.com
 (c) 2010-2016 Vladimir Agafonkin, (c) 2010-2011 CloudMade
*/

(function(e,t,n){function i(){var t=e.L;r.noConflict=function(){return e.L=t,this},e.L=r}var r={version:"1.0.0"};typeof module=="object"&&typeof module.exports=="object"?module.exports=r:typeof define=="function"&&define.amd&&define(r),typeof e!="undefined"&&i(),r.Util={extend:function(e){var t,n,r,i;for(n=1,r=arguments.length;n<r;n++){i=arguments[n];for(t in i)e[t]=i[t]}return e},create:Object.create||function(){function e(){}return function(t){return e.prototype=t,new e}}(),bind:function(e,t){var n=Array.prototype.slice;if(e.bind)return e.bind.apply(e,n.call(arguments,1));var r=n.call(arguments,2);return function(){return e.apply(t,r.length?r.concat(n.call(arguments)):arguments)}},stamp:function(e){return e._leaflet_id=e._leaflet_id||++r.Util.lastId,e._leaflet_id},lastId:0,throttle:function(e,t,n){var r,i,s,o;return o=function(){r=!1,i&&(s.apply(n,i),i=!1)},s=function(){r?i=arguments:(e.apply(n,arguments),setTimeout(o,t),r=!0)},s},wrapNum:function(e,t,n){var r=t[1],i=t[0],s=r-i;return e===r&&n?e:((e-i)%s+s)%s+i},falseFn:function(){return!1},formatNum:function(e,t){var n=Math.pow(10,t||5);return Math.round(e*n)/n},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},splitWords:function(e){return r.Util.trim(e).split(/\s+/)},setOptions:function(e,t){e.hasOwnProperty("options")||(e.options=e.options?r.Util.create(e.options):{});for(var n in t)e.options[n]=t[n];return e.options},getParamString:function(e,t,n){var r=[];for(var i in e)r.push(encodeURIComponent(n?i.toUpperCase():i)+"="+encodeURIComponent(e[i]));return(!t||t.indexOf("?")===-1?"?":"&")+r.join("&")},template:function(e,t){return e.replace(r.Util.templateRe,function(e,r){var i=t[r];if(i===n)throw new Error("No value provided for variable "+e);return typeof i=="function"&&(i=i(t)),i})},templateRe:/\{ *([\w_\-]+) *\}/g,isArray:Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"},indexOf:function(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},function(){function t(t){return e["webkit"+t]||e["moz"+t]||e["ms"+t]}function i(t){var r=+(new Date),i=Math.max(0,16-(r-n));return n=r+i,e.setTimeout(t,i)}var n=0,s=e.requestAnimationFrame||t("RequestAnimationFrame")||i,o=e.cancelAnimationFrame||t("CancelAnimationFrame")||t("CancelRequestAnimationFrame")||function(t){e.clearTimeout(t)};r.Util.requestAnimFrame=function(t,n,o){if(!o||s!==i)return s.call(e,r.bind(t,n));t.call(n)},r.Util.cancelAnimFrame=function(t){t&&o.call(e,t)}}(),r.extend=r.Util.extend,r.bind=r.Util.bind,r.stamp=r.Util.stamp,r.setOptions=r.Util.setOptions,r.Class=function(){},r.Class.extend=function(e){var t=function(){this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},n=t.__super__=this.prototype,i=r.Util.create(n);i.constructor=t,t.prototype=i;for(var s in this)this.hasOwnProperty(s)&&s!=="prototype"&&(t[s]=this[s]);return e.statics&&(r.extend(t,e.statics),delete e.statics),e.includes&&(r.Util.extend.apply(null,[i].concat(e.includes)),delete e.includes),i.options&&(e.options=r.Util.extend(r.Util.create(i.options),e.options)),r.extend(i,e),i._initHooks=[],i.callInitHooks=function(){if(this._initHooksCalled)return;n.callInitHooks&&n.callInitHooks.call(this),this._initHooksCalled=!0;for(var e=0,t=i._initHooks.length;e<t;e++)i._initHooks[e].call(this)},t},r.Class.include=function(e){return r.extend(this.prototype,e),this},r.Class.mergeOptions=function(e){return r.extend(this.prototype.options,e),this},r.Class.addInitHook=function(e){var t=Array.prototype.slice.call(arguments,1),n=typeof e=="function"?e:function(){this[e].apply(this,t)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(n),this},r.Evented=r.Class.extend({on:function(e,t,n){if(typeof e=="object")for(var i in e)this._on(i,e[i],t);else{e=r.Util.splitWords(e);for(var s=0,o=e.length;s<o;s++)this._on(e[s],t,n)}return this},off:function(e,t,n){if(!e)delete this._events;else if(typeof e=="object")for(var i in e)this._off(i,e[i],t);else{e=r.Util.splitWords(e);for(var s=0,o=e.length;s<o;s++)this._off(e[s],t,n)}return this},_on:function(e,t,r){this._events=this._events||{};var i=this._events[e];i||(i=[],this._events[e]=i),r===this&&(r=n);var s={fn:t,ctx:r},o=i;for(var u=0,a=o.length;u<a;u++)if(o[u].fn===t&&o[u].ctx===r)return;o.push(s),i.count++},_off:function(e,t,i){var s,o,u;if(!this._events)return;s=this._events[e];if(!s)return;if(!t){for(o=0,u=s.length;o<u;o++)s[o].fn=r.Util.falseFn;delete this._events[e];return}i===this&&(i=n);if(s)for(o=0,u=s.length;o<u;o++){var a=s[o];if(a.ctx!==i)continue;if(a.fn===t){a.fn=r.Util.falseFn,this._firingCount&&(this._events[e]=s=s.slice()),s.splice(o,1);return}}},fire:function(e,t,n){if(!this.listens(e,n))return this;var i=r.Util.extend({},t,{type:e,target:this});if(this._events){var s=this._events[e];if(s){this._firingCount=this._firingCount+1||1;for(var o=0,u=s.length;o<u;o++){var a=s[o];a.fn.call(a.ctx||this,i)}this._firingCount--}}return n&&this._propagateEvent(i),this},listens:function(e,t){var n=this._events&&this._events[e];if(n&&n.length)return!0;if(t)for(var r in this._eventParents)if(this._eventParents[r].listens(e,t))return!0;return!1},once:function(e,t,n){if(typeof e=="object"){for(var i in e)this.once(i,e[i],t);return this}var s=r.bind(function(){this.off(e,t,n).off(e,s,n)},this);return this.on(e,t,n).on(e,s,n)},addEventParent:function(e){return this._eventParents=this._eventParents||{},this._eventParents[r.stamp(e)]=e,this},removeEventParent:function(e){return this._eventParents&&delete this._eventParents[r.stamp(e)],this},_propagateEvent:function(e){for(var t in this._eventParents)this._eventParents[t].fire(e.type,r.extend({layer:e.target},e),!0)}});var s=r.Evented.prototype;s.addEventListener=s.on,s.removeEventListener=s.clearAllEventListeners=s.off,s.addOneTimeEventListener=s.once,s.fireEvent=s.fire,s.hasEventListeners=s.listens,r.Mixin={Events:s},function(){var n=navigator.userAgent.toLowerCase(),i=t.documentElement,s="ActiveXObject"in e,o=n.indexOf("webkit")!==-1,u=n.indexOf("phantom")!==-1,a=n.search("android [23]")!==-1,f=n.indexOf("chrome")!==-1,l=n.indexOf("gecko")!==-1&&!o&&!e.opera&&!s,c=navigator.platform.indexOf("Win")===0,h=typeof orientation!="undefined"||n.indexOf("mobile")!==-1,p=!e.PointerEvent&&e.MSPointerEvent,d=e.PointerEvent||p,v=s&&"transition"in i.style,m="WebKitCSSMatrix"in e&&"m11"in new e.WebKitCSSMatrix&&!a,g="MozPerspective"in i.style,y="OTransition"in i.style,b=!e.L_NO_TOUCH&&(d||"ontouchstart"in e||e.DocumentTouch&&t instanceof e.DocumentTouch);r.Browser={ie:s,ielt9:s&&!t.addEventListener,edge:"msLaunchUri"in navigator&&!("documentMode"in t),webkit:o,gecko:l,android:n.indexOf("android")!==-1,android23:a,chrome:f,safari:!f&&n.indexOf("safari")!==-1,win:c,ie3d:v,webkit3d:m,gecko3d:g,opera12:y,any3d:!e.L_DISABLE_3D&&(v||m||g)&&!y&&!u,mobile:h,mobileWebkit:h&&o,mobileWebkit3d:h&&m,mobileOpera:h&&e.opera,mobileGecko:h&&l,touch:!!b,msPointer:!!p,pointer:!!d,retina:(e.devicePixelRatio||e.screen.deviceXDPI/e.screen.logicalXDPI)>1}}(),r.Point=function(e,t,n){this.x=n?Math.round(e):e,this.y=n?Math.round(t):t},r.Point.prototype={clone:function(){return new r.Point(this.x,this.y)},add:function(e){return this.clone()._add(r.point(e))},_add:function(e){return this.x+=e.x,this.y+=e.y,this},subtract:function(e){return this.clone()._subtract(r.point(e))},_subtract:function(e){return this.x-=e.x,this.y-=e.y,this},divideBy:function(e){return this.clone()._divideBy(e)},_divideBy:function(e){return this.x/=e,this.y/=e,this},multiplyBy:function(e){return this.clone()._multiplyBy(e)},_multiplyBy:function(e){return this.x*=e,this.y*=e,this},scaleBy:function(e){return new r.Point(this.x*e.x,this.y*e.y)},unscaleBy:function(e){return new r.Point(this.x/e.x,this.y/e.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},distanceTo:function(e){e=r.point(e);var t=e.x-this.x,n=e.y-this.y;return Math.sqrt(t*t+n*n)},equals:function(e){return e=r.point(e),e.x===this.x&&e.y===this.y},contains:function(e){return e=r.point(e),Math.abs(e.x)<=Math.abs(this.x)&&Math.abs(e.y)<=Math.abs(this.y)},toString:function(){return"Point("+r.Util.formatNum(this.x)+", "+r.Util.formatNum(this.y)+")"}},r.point=function(e,t,i){return e instanceof r.Point?e:r.Util.isArray(e)?new r.Point(e[0],e[1]):e===n||e===null?e:typeof e=="object"&&"x"in e&&"y"in e?new r.Point(e.x,e.y):new r.Point(e,t,i)},r.Bounds=function(e,t){if(!e)return;var n=t?[e,t]:e;for(var r=0,i=n.length;r<i;r++)this.extend(n[r])},r.Bounds.prototype={extend:function(e){return e=r.point(e),!this.min&&!this.max?(this.min=e.clone(),this.max=e.clone()):(this.min.x=Math.min(e.x,this.min.x),this.max.x=Math.max(e.x,this.max.x),this.min.y=Math.min(e.y,this.min.y),this.max.y=Math.max(e.y,this.max.y)),this},getCenter:function(e){return new r.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,e)},getBottomLeft:function(){return new r.Point(this.min.x,this.max.y)},getTopRight:function(){return new r.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(e){var t,n;return typeof e[0]=="number"||e instanceof r.Point?e=r.point(e):e=r.bounds(e),e instanceof r.Bounds?(t=e.min,n=e.max):t=n=e,t.x>=this.min.x&&n.x<=this.max.x&&t.y>=this.min.y&&n.y<=this.max.y},intersects:function(e){e=r.bounds(e);var t=this.min,n=this.max,i=e.min,s=e.max,o=s.x>=t.x&&i.x<=n.x,u=s.y>=t.y&&i.y<=n.y;return o&&u},overlaps:function(e){e=r.bounds(e);var t=this.min,n=this.max,i=e.min,s=e.max,o=s.x>t.x&&i.x<n.x,u=s.y>t.y&&i.y<n.y;return o&&u},isValid:function(){return!!this.min&&!!this.max}},r.bounds=function(e,t){return!e||e instanceof r.Bounds?e:new r.Bounds(e,t)},r.Transformation=function(e,t,n,r){this._a=e,this._b=t,this._c=n,this._d=r},r.Transformation.prototype={transform:function(e,t){return this._transform(e.clone(),t)},_transform:function(e,t){return t=t||1,e.x=t*(this._a*e.x+this._b),e.y=t*(this._c*e.y+this._d),e},untransform:function(e,t){return t=t||1,new r.Point((e.x/t-this._b)/this._a,(e.y/t-this._d)/this._c)}},r.DomUtil={get:function(e){return typeof e=="string"?t.getElementById(e):e},getStyle:function(e,n){var r=e.style[n]||e.currentStyle&&e.currentStyle[n];if((!r||r==="auto")&&t.defaultView){var i=t.defaultView.getComputedStyle(e,null);r=i?i[n]:null}return r==="auto"?null:r},create:function(e,n,r){var i=t.createElement(e);return i.className=n||"",r&&r.appendChild(i),i},remove:function(e){var t=e.parentNode;t&&t.removeChild(e)},empty:function(e){while(e.firstChild)e.removeChild(e.firstChild)},toFront:function(e){e.parentNode.appendChild(e)},toBack:function(e){var t=e.parentNode;t.insertBefore(e,t.firstChild)},hasClass:function(e,t){if(e.classList!==n)return e.classList.contains(t);var i=r.DomUtil.getClass(e);return i.length>0&&(new RegExp("(^|\\s)"+t+"(\\s|$)")).test(i)},addClass:function(e,t){if(e.classList!==n){var i=r.Util.splitWords(t);for(var s=0,o=i.length;s<o;s++)e.classList.add(i[s])}else if(!r.DomUtil.hasClass(e,t)){var u=r.DomUtil.getClass(e);r.DomUtil.setClass(e,(u?u+" ":"")+t)}},removeClass:function(e,t){e.classList!==n?e.classList.remove(t):r.DomUtil.setClass(e,r.Util.trim((" "+r.DomUtil.getClass(e)+" ").replace(" "+t+" "," ")))},setClass:function(e,t){e.className.baseVal===n?e.className=t:e.className.baseVal=t},getClass:function(e){return e.className.baseVal===n?e.className:e.className.baseVal},setOpacity:function(e,t){"opacity"in e.style?e.style.opacity=t:"filter"in e.style&&r.DomUtil._setOpacityIE(e,t)},_setOpacityIE:function(e,t){var n=!1,r="DXImageTransform.Microsoft.Alpha";try{n=e.filters.item(r)}catch(i){if(t===1)return}t=Math.round(t*100),n?(n.Enabled=t!==100,n.Opacity=t):e.style.filter+=" progid:"+r+"(opacity="+t+")"},testProp:function(e){var n=t.documentElement.style;for(var r=0;r<e.length;r++)if(e[r]in n)return e[r];return!1},setTransform:function(e,t,n){var i=t||new r.Point(0,0);e.style[r.DomUtil.TRANSFORM]=(r.Browser.ie3d?"translate("+i.x+"px,"+i.y+"px)":"translate3d("+i.x+"px,"+i.y+"px,0)")+(n?" scale("+n+")":"")},setPosition:function(e,t){e._leaflet_pos=t,r.Browser.any3d?r.DomUtil.setTransform(e,t):(e.style.left=t.x+"px",e.style.top=t.y+"px")},getPosition:function(e){return e._leaflet_pos||new r.Point(0,0)}},function(){r.DomUtil.TRANSFORM=r.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]);var n=r.DomUtil.TRANSITION=r.DomUtil.testProp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]);r.DomUtil.TRANSITION_END=n==="webkitTransition"||n==="OTransition"?n+"End":"transitionend";if("onselectstart"in t)r.DomUtil.disableTextSelection=function(){r.DomEvent.on(e,"selectstart",r.DomEvent.preventDefault)},r.DomUtil.enableTextSelection=function(){r.DomEvent.off(e,"selectstart",r.DomEvent.preventDefault)};else{var i=r.DomUtil.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);r.DomUtil.disableTextSelection=function(){if(i){var e=t.documentElement.style;this._userSelect=e[i],e[i]="none"}},r.DomUtil.enableTextSelection=function(){i&&(t.documentElement.style[i]=this._userSelect,delete this._userSelect)}}r.DomUtil.disableImageDrag=function(){r.DomEvent.on(e,"dragstart",r.DomEvent.preventDefault)},r.DomUtil.enableImageDrag=function(){r.DomEvent.off(e,"dragstart",r.DomEvent.preventDefault)},r.DomUtil.preventOutline=function(t){while(t.tabIndex===-1)t=t.parentNode;if(!t||!t.style)return;r.DomUtil.restoreOutline(),this._outlineElement=t,this._outlineStyle=t.style.outline,t.style.outline="none",r.DomEvent.on(e,"keydown",r.DomUtil.restoreOutline,this)},r.DomUtil.restoreOutline=function(){if(!this._outlineElement)return;this._outlineElement.style.outline=this._outlineStyle,delete this._outlineElement,delete this._outlineStyle,r.DomEvent.off(e,"keydown",r.DomUtil.restoreOutline,this)}}(),r.LatLng=function(e,t,r){if(isNaN(e)||isNaN(t))throw new Error("Invalid LatLng object: ("+e+", "+t+")");this.lat=+e,this.lng=+t,r!==n&&(this.alt=+r)},r.LatLng.prototype={equals:function(e,t){if(!e)return!1;e=r.latLng(e);var i=Math.max(Math.abs(this.lat-e.lat),Math.abs(this.lng-e.lng));return i<=(t===n?1e-9:t)},toString:function(e){return"LatLng("+r.Util.formatNum(this.lat,e)+", "+r.Util.formatNum(this.lng,e)+")"},distanceTo:function(e){return r.CRS.Earth.distance(this,r.latLng(e))},wrap:function(){return r.CRS.Earth.wrapLatLng(this)},toBounds:function(e){var t=180*e/40075017,n=t/Math.cos(Math.PI/180*this.lat);return r.latLngBounds([this.lat-t,this.lng-n],[this.lat+t,this.lng+n])},clone:function(){return new r.LatLng(this.lat,this.lng,this.alt)}},r.latLng=function(e,t,i){return e instanceof r.LatLng?e:r.Util.isArray(e)&&typeof e[0]!="object"?e.length===3?new r.LatLng(e[0],e[1],e[2]):e.length===2?new r.LatLng(e[0],e[1]):null:e===n||e===null?e:typeof e=="object"&&"lat"in e?new r.LatLng(e.lat,"lng"in e?e.lng:e.lon,e.alt):t===n?null:new r.LatLng(e,t,i)},r.LatLngBounds=function(e,t){if(!e)return;var n=t?[e,t]:e;for(var r=0,i=n.length;r<i;r++)this.extend(n[r])},r.LatLngBounds.prototype={extend:function(e){var t=this._southWest,n=this._northEast,i,s;if(e instanceof r.LatLng)i=e,s=e;else{if(!(e instanceof r.LatLngBounds))return e?this.extend(r.latLng(e)||r.latLngBounds(e)):this;i=e._southWest,s=e._northEast;if(!i||!s)return this}return!t&&!n?(this._southWest=new r.LatLng(i.lat,i.lng),this._northEast=new r.LatLng(s.lat,s.lng)):(t.lat=Math.min(i.lat,t.lat),t.lng=Math.min(i.lng,t.lng),n.lat=Math.max(s.lat,n.lat),n.lng=Math.max(s.lng,n.lng)),this},pad:function(e){var t=this._southWest,n=this._northEast,i=Math.abs(t.lat-n.lat)*e,s=Math.abs(t.lng-n.lng)*e;return new r.LatLngBounds(new r.LatLng(t.lat-i,t.lng-s),new r.LatLng(n.lat+i,n.lng+s))},getCenter:function(){return new r.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new r.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new r.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(e){typeof e[0]=="number"||e instanceof r.LatLng?e=r.latLng(e):e=r.latLngBounds(e);var t=this._southWest,n=this._northEast,i,s;return e instanceof r.LatLngBounds?(i=e.getSouthWest(),s=e.getNorthEast()):i=s=e,i.lat>=t.lat&&s.lat<=n.lat&&i.lng>=t.lng&&s.lng<=n.lng},intersects:function(e){e=r.latLngBounds(e);var t=this._southWest,n=this._northEast,i=e.getSouthWest(),s=e.getNorthEast(),o=s.lat>=t.lat&&i.lat<=n.lat,u=s.lng>=t.lng&&i.lng<=n.lng;return o&&u},overlaps:function(e){e=r.latLngBounds(e);var t=this._southWest,n=this._northEast,i=e.getSouthWest(),s=e.getNorthEast(),o=s.lat>t.lat&&i.lat<n.lat,u=s.lng>t.lng&&i.lng<n.lng;return o&&u},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(e){return e?(e=r.latLngBounds(e),this._southWest.equals(e.getSouthWest())&&this._northEast.equals(e.getNorthEast())):!1},isValid:function(){return!!this._southWest&&!!this._northEast}},r.latLngBounds=function(e,t){return e instanceof r.LatLngBounds?e:new r.LatLngBounds(e,t)},r.Projection={},r.Projection.LonLat={project:function(e){return new r.Point(e.lng,e.lat)},unproject:function(e){return new r.LatLng(e.y,e.x)},bounds:r.bounds([-180,-90],[180,90])},r.Projection.SphericalMercator={R:6378137,MAX_LATITUDE:85.0511287798,project:function(e){var t=Math.PI/180,n=this.MAX_LATITUDE,i=Math.max(Math.min(n,e.lat),-n),s=Math.sin(i*t);return new r.Point(this.R*e.lng*t,this.R*Math.log((1+s)/(1-s))/2)},unproject:function(e){var t=180/Math.PI;return new r.LatLng((2*Math.atan(Math.exp(e.y/this.R))-Math.PI/2)*t,e.x*t/this.R)},bounds:function(){var e=6378137*Math.PI;return r.bounds([-e,-e],[e,e])}()},r.CRS={latLngToPoint:function(e,t){var n=this.projection.project(e),r=this.scale(t);return this.transformation._transform(n,r)},pointToLatLng:function(e,t){var n=this.scale(t),r=this.transformation.untransform(e,n);return this.projection.unproject(r)},project:function(e){return this.projection.project(e)},unproject:function(e){return this.projection.unproject(e)},scale:function(e){return 256*Math.pow(2,e)},zoom:function(e){return Math.log(e/256)/Math.LN2},getProjectedBounds:function(e){if(this.infinite)return null;var t=this.projection.bounds,n=this.scale(e),i=this.transformation.transform(t.min,n),s=this.transformation.transform(t.max,n);return r.bounds(i,s)},infinite:!1,wrapLatLng:function(e){var t=this.wrapLng?r.Util.wrapNum(e.lng,this.wrapLng,!0):e.lng,n=this.wrapLat?r.Util.wrapNum(e.lat,this.wrapLat,!0):e.lat,i=e.alt;return r.latLng(n,t,i)}},r.CRS.Simple=r.extend({},r.CRS,{projection:r.Projection.LonLat,transformation:new r.Transformation(1,0,-1,0),scale:function(e){return Math.pow(2,e)},zoom:function(e){return Math.log(e)/Math.LN2},distance:function(e,t){var n=t.lng-e.lng,r=t.lat-e.lat;return Math.sqrt(n*n+r*r)},infinite:!0}),r.CRS.Earth=r.extend({},r.CRS,{wrapLng:[-180,180],R:6371e3,distance:function(e,t){var n=Math.PI/180,r=e.lat*n,i=t.lat*n,s=Math.sin(r)*Math.sin(i)+Math.cos(r)*Math.cos(i)*Math.cos((t.lng-e.lng)*n);return this.R*Math.acos(Math.min(s,1))}}),r.CRS.EPSG3857=r.extend({},r.CRS.Earth,{code:"EPSG:3857",projection:r.Projection.SphericalMercator,transformation:function(){var e=.5/(Math.PI*r.Projection.SphericalMercator.R);return new r.Transformation(e,.5,-e,.5)}()}),r.CRS.EPSG900913=r.extend({},r.CRS.EPSG3857,{code:"EPSG:900913"}),r.CRS.EPSG4326=r.extend({},r.CRS.Earth,{code:"EPSG:4326",projection:r.Projection.LonLat,transformation:new r.Transformation(1/180,1,-1/180,.5)}),r.Map=r.Evented.extend({options:{crs:r.CRS.EPSG3857,center:n,zoom:n,minZoom:n,maxZoom:n,layers:[],maxBounds:n,renderer:n,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(e,t){t=r.setOptions(this,t),this._initContainer(e),this._initLayout(),this._onResize=r.bind(this._onResize,this),this._initEvents(),t.maxBounds&&this.setMaxBounds(t.maxBounds),t.zoom!==n&&(this._zoom=this._limitZoom(t.zoom)),t.center&&t.zoom!==n&&this.setView(r.latLng(t.center),t.zoom,{reset:!0}),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this.callInitHooks(),this._addLayers(this.options.layers)},setView:function(e,t){return t=t===n?this.getZoom():t,this._resetView(r.latLng(e),t),this},setZoom:function(e,t){return this._loaded?this.setView(this.getCenter(),e,{zoom:t}):(this._zoom=e,this)},zoomIn:function(e,t){return e=e||(r.Browser.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+e,t)},zoomOut:function(e,t){return e=e||(r.Browser.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-e,t)},setZoomAround:function(e,t,n){var i=this.getZoomScale(t),s=this.getSize().divideBy(2),o=e instanceof r.Point?e:this.latLngToContainerPoint(e),u=o.subtract(s).multiplyBy(1-1/i),a=this.containerPointToLatLng(s.add(u));return this.setView(a,t,{zoom:n})},_getBoundsCenterZoom:function(e,t){t=t||{},e=e.getBounds?e.getBounds():r.latLngBounds(e);var n=r.point(t.paddingTopLeft||t.padding||[0,0]),i=r.point(t.paddingBottomRight||t.padding||[0,0]),s=this.getBoundsZoom(e,!1,n.add(i));s=typeof t.maxZoom=="number"?Math.min(t.maxZoom,s):s;var o=i.subtract(n).divideBy(2),u=this.project(e.getSouthWest(),s),a=this.project(e.getNorthEast(),s),f=this.unproject(u.add(a).divideBy(2).add(o),s);return{center:f,zoom:s}},fitBounds:function(e,t){e=r.latLngBounds(e);if(!e.isValid())throw new Error("Bounds are not valid.");var n=this._getBoundsCenterZoom(e,t);return this.setView(n.center,n.zoom,t)},fitWorld:function(e){return this.fitBounds([[-90,-180],[90,180]],e)},panTo:function(e,t){return this.setView(e,this._zoom,{pan:t})},panBy:function(e){return this.fire("movestart"),this._rawPanBy(r.point(e)),this.fire("move"),this.fire("moveend")},setMaxBounds:function(e){return e=r.latLngBounds(e),e.isValid()?(this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this.options.maxBounds=e,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this.off("moveend",this._panInsideMaxBounds))},setMinZoom:function(e){return this.options.minZoom=e,this._loaded&&this.getZoom()<this.options.minZoom?this.setZoom(e):this},setMaxZoom:function(e){return this.options.maxZoom=e,this._loaded&&this.getZoom()>this.options.maxZoom?this.setZoom(e):this},panInsideBounds:function(e,t){this._enforcingBounds=!0;var n=this.getCenter(),i=this._limitCenter(n,this._zoom,r.latLngBounds(e));return n.equals(i)||this.panTo(i,t),this._enforcingBounds=!1,this},invalidateSize:function(e){if(!this._loaded)return this;e=r.extend({animate:!1,pan:!0},e===!0?{animate:!0}:e);var t=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var n=this.getSize(),i=t.divideBy(2).round(),s=n.divideBy(2).round(),o=i.subtract(s);return!o.x&&!o.y?this:(e.animate&&e.pan?this.panBy(o):(e.pan&&this._rawPanBy(o),this.fire("move"),e.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(r.bind(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:t,newSize:n}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},addHandler:function(e,t){if(!t)return this;var n=this[e]=new t(this);return this._handlers.push(n),this.options[e]&&n.enable(),this},remove:function(){this._initEvents(!0);if(this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(e){this._container._leaflet_id=n,this._containerId=n}r.DomUtil.remove(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._clearHandlers(),this._loaded&&this.fire("unload");for(var t in this._layers)this._layers[t].remove();return this},createPane:function(e,t){var n="leaflet-pane"+(e?" leaflet-"+e.replace("Pane","")+"-pane":""),i=r.DomUtil.create("div",n,t||this._mapPane);return e&&(this._panes[e]=i),i},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var e=this.getPixelBounds(),t=this.unproject(e.getBottomLeft()),n=this.unproject(e.getTopRight());return new r.LatLngBounds(t,n)},getMinZoom:function(){return this.options.minZoom===n?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===n?this._layersMaxZoom===n?Infinity:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(e,t,n){e=r.latLngBounds(e),n=r.point(n||[0,0]);var i=this.getZoom()||0,s=this.getMinZoom(),o=this.getMaxZoom(),u=e.getNorthWest(),a=e.getSouthEast(),f=this.getSize().subtract(n),l=this.project(a,i).subtract(this.project(u,i)),c=r.Browser.any3d?this.options.zoomSnap:1,h=Math.min(f.x/l.x,f.y/l.y);return i=this.getScaleZoom(h,i),c&&(i=Math.round(i/(c/100))*(c/100),i=t?Math.ceil(i/c)*c:Math.floor(i/c)*c),Math.max(s,Math.min(o,i))},getSize:function(){if(!this._size||this._sizeChanged)this._size=new r.Point(this._container.clientWidth,this._container.clientHeight),this._sizeChanged=!1;return this._size.clone()},getPixelBounds:function(e,t){var n=this._getTopLeftPoint(e,t);return new r.Bounds(n,n.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(e){return this.options.crs.getProjectedBounds(e===n?this.getZoom():e)},getPane:function(e){return typeof e=="string"?this._panes[e]:e},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(e,t){var r=this.options.crs;return t=t===n?this._zoom:t,r.scale(e)/r.scale(t)},getScaleZoom:function(e,t){var r=this.options.crs;t=t===n?this._zoom:t;var i=r.zoom(e*r.scale(t));return isNaN(i)?Infinity:i},project:function(e,t){return t=t===n?this._zoom:t,this.options.crs.latLngToPoint(r.latLng(e),t)},unproject:function(e,t){return t=t===n?this._zoom:t,this.options.crs.pointToLatLng(r.point(e),t)},layerPointToLatLng:function(e){var t=r.point(e).add(this.getPixelOrigin());return this.unproject(t)},latLngToLayerPoint:function(e){var t=this.project(r.latLng(e))._round();return t._subtract(this.getPixelOrigin())},wrapLatLng:function(e){return this.options.crs.wrapLatLng(r.latLng(e))},distance:function(e,t){return this.options.crs.distance(r.latLng(e),r.latLng(t))},containerPointToLayerPoint:function(e){return r.point(e).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(e){return r.point(e).add(this._getMapPanePos())},containerPointToLatLng:function(e){var t=this.containerPointToLayerPoint(r.point(e));return this.layerPointToLatLng(t)},latLngToContainerPoint:function(e){return this.layerPointToContainerPoint(this.latLngToLayerPoint(r.latLng(e)))},mouseEventToContainerPoint:function(e){return r.DomEvent.getMousePosition(e,this._container)},mouseEventToLayerPoint:function(e){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(e))},mouseEventToLatLng:function(e){return this.layerPointToLatLng(this.mouseEventToLayerPoint(e))},_initContainer:function(e){var t=this._container=r.DomUtil.get(e);if(!t)throw new Error("Map container not found.");if(t._leaflet_id)throw new Error("Map container is already initialized.");r.DomEvent.addListener(t,"scroll",this._onScroll,this),this._containerId=r.Util.stamp(t)},_initLayout:function(){var e=this._container;this._fadeAnimated=this.options.fadeAnimation&&r.Browser.any3d,r.DomUtil.addClass(e,"leaflet-container"+(r.Browser.touch?" leaflet-touch":"")+(r.Browser.retina?" leaflet-retina":"")+(r.Browser.ielt9?" leaflet-oldie":"")+(r.Browser.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var t=r.DomUtil.getStyle(e,"position");t!=="absolute"&&t!=="relative"&&t!=="fixed"&&(e.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var e=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),r.DomUtil.setPosition(this._mapPane,new r.Point(0,0)),this.createPane("tilePane"),this.createPane("shadowPane"),this.createPane("overlayPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(r.DomUtil.addClass(e.markerPane,"leaflet-zoom-hide"),r.DomUtil.addClass(e.shadowPane,"leaflet-zoom-hide"))},_resetView:function(e,t){r.DomUtil.setPosition(this._mapPane,new r.Point(0,0));var n=!this._loaded;this._loaded=!0,t=this._limitZoom(t),this.fire("viewprereset");var i=this._zoom!==t;this._moveStart(i)._move(e,t)._moveEnd(i),this.fire("viewreset"),n&&this.fire("load")},_moveStart:function(e){return e&&this.fire("zoomstart"),this.fire("movestart")},_move:function(e,t,r){t===n&&(t=this._zoom);var i=this._zoom!==t;return this._zoom=t,this._lastCenter=e,this._pixelOrigin=this._getNewPixelOrigin(e),(i||r&&r.pinch)&&this.fire("zoom",r),this.fire("move",r)},_moveEnd:function(e){return e&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return r.Util.cancelAnimFrame(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(e){r.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(e))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){if(!r.DomEvent)return;this._targets={},this._targets[r.stamp(this._container)]=this;var n=t?"off":"on";r.DomEvent[n](this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress",this._handleDOMEvent,this),this.options.trackResize&&r.DomEvent[n](e,"resize",this._onResize,this),r.Browser.any3d&&this.options.transform3DLimit&&this[n]("moveend",this._onMoveEnd)},_onResize:function(){r.Util.cancelAnimFrame(this._resizeRequest),this._resizeRequest=r.Util.requestAnimFrame(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var e=this._getMapPanePos();Math.max(Math.abs(e.x),Math.abs(e.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(e,t){var n=[],i,s=t==="mouseout"||t==="mouseover",o=e.target||e.srcElement,u=!1;while(o){i=this._targets[r.stamp(o)];if(i&&(t==="click"||t==="preclick")&&!e._simulated&&this._draggableMoved(i)){u=!0;break}if(i&&i.listens(t,!0)){if(s&&!r.DomEvent._isExternalTarget(o,e))break;n.push(i);if(s)break}if(o===this._container)break;o=o.parentNode}return!n.length&&!u&&!s&&r.DomEvent._isExternalTarget(o,e)&&(n=[this]),n},_handleDOMEvent:function(e){if(!this._loaded||r.DomEvent._skipped(e))return;var t=e.type==="keypress"&&e.keyCode===13?"click":e.type;t==="mousedown"&&r.DomUtil.preventOutline(e.target||e.srcElement),this._fireDOMEvent(e,t)},_fireDOMEvent:function(e,t,n){if(e.type==="click"){var i=r.Util.extend({},e);i.type="preclick",this._fireDOMEvent(i,i.type,n)}if(e._stopped)return;n=(n||[]).concat(this._findEventTargets(e,t));if(!n.length)return;var s=n[0];t==="contextmenu"&&s.listens(t,!0)&&r.DomEvent.preventDefault(e);var o={originalEvent:e};if(e.type!=="keypress"){var u=s instanceof r.Marker;o.containerPoint=u?this.latLngToContainerPoint(s.getLatLng()):this.mouseEventToContainerPoint(e),o.layerPoint=this.containerPointToLayerPoint(o.containerPoint),o.latlng=u?s.getLatLng():this.layerPointToLatLng(o.layerPoint)}for(var a=0;a<n.length;a++){n[a].fire(t,o,!0);if(o.originalEvent._stopped||n[a].options.nonBubblingEvents&&r.Util.indexOf(n[a].options.nonBubblingEvents,t)!==-1)return}},_draggableMoved:function(e){return e=e.dragging&&e.dragging.enabled()?e:this,e.dragging&&e.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var e=0,t=this._handlers.length;e<t;e++)this._handlers[e].disable()},whenReady:function(e,t){return this._loaded?e.call(t||this,{target:this}):this.on("load",e,t),this},_getMapPanePos:function(){return r.DomUtil.getPosition(this._mapPane)||new r.Point(0,0)},_moved:function(){var e=this._getMapPanePos();return e&&!e.equals([0,0])},_getTopLeftPoint:function(e,t){var r=e&&t!==n?this._getNewPixelOrigin(e,t):this.getPixelOrigin();return r.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(e,t){var n=this.getSize()._divideBy(2);return this.project(e,t)._subtract(n)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(e,t,n){var r=this._getNewPixelOrigin(n,t);return this.project(e,t)._subtract(r)},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(e){return this.latLngToLayerPoint(e).subtract(this._getCenterLayerPoint())},_limitCenter:function(e,t,n){if(!n)return e;var i=this.project(e,t),s=this.getSize().divideBy(2),o=new r.Bounds(i.subtract(s),i.add(s)),u=this._getBoundsOffset(o,n,t);return u.round().equals([0,0])?e:this.unproject(i.add(u),t)},_limitOffset:function(e,t){if(!t)return e;var n=this.getPixelBounds(),i=new r.Bounds(n.min.add(e),n.max.add(e));return e.add(this._getBoundsOffset(i,t))},_getBoundsOffset:function(e,t,n){var i=r.bounds(this.project(t.getNorthEast(),n),this.project(t.getSouthWest(),n)),s=i.min.subtract(e.min),o=i.max.subtract(e.max),u=this._rebound(s.x,-o.x),a=this._rebound(s.y,-o.y);return new r.Point(u,a)},_rebound:function(e,t){return e+t>0?Math.round(e-t)/2:Math.max(0,Math.ceil(e))-Math.max(0,Math.floor(t))},_limitZoom:function(e){var t=this.getMinZoom(),n=this.getMaxZoom(),i=r.Browser.any3d?this.options.zoomSnap:1;return i&&(e=Math.round(e/i)*i),Math.max(t,Math.min(n,e))}}),r.map=function(e,t){return new r.Map(e,t)},r.Layer=r.Evented.extend({options:{pane:"overlayPane",nonBubblingEvents:[]},addTo:function(e){return e.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(e){return e&&e.removeLayer(this),this},getPane:function(e){return this._map.getPane(e?this.options[e]||e:this.options.pane)},addInteractiveTarget:function(e){return this._map._targets[r.stamp(e)]=this,this},removeInteractiveTarget:function(e){return delete this._map._targets[r.stamp(e)],this},_layerAdd:function(e){var t=e.target;if(!t.hasLayer(this))return;this._map=t,this._zoomAnimated=t._zoomAnimated;if(this.getEvents){var n=this.getEvents();t.on(n,this),this.once("remove",function(){t.off(n,this)},this)}this.onAdd(t),this.getAttribution&&this._map.attributionControl&&this._map.attributionControl.addAttribution(this.getAttribution()),this.fire("add"),t.fire("layeradd",{layer:this})}}),r.Map.include({addLayer:function(e){var t=r.stamp(e);return this._layers[t]?this:(this._layers[t]=e,e._mapToAdd=this,e.beforeAdd&&e.beforeAdd(this),this.whenReady(e._layerAdd,e),this)},removeLayer:function(e){var t=r.stamp(e);return this._layers[t]?(this._loaded&&e.onRemove(this),e.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(e.getAttribution()),delete this._layers[t],this._loaded&&(this.fire("layerremove",{layer:e}),e.fire("remove")),e._map=e._mapToAdd=null,this):this},hasLayer:function(e){return!!e&&r.stamp(e)in this._layers},eachLayer:function(e,t){for(var n in this._layers)e.call(t,this._layers[n]);return this},_addLayers:function(e){e=e?r.Util.isArray(e)?e:[e]:[];for(var t=0,n=e.length;t<n;t++)this.addLayer(e[t])},_addZoomLimit:function(e){if(isNaN(e.options.maxZoom)||!isNaN(e.options.minZoom))this._zoomBoundLayers[r.stamp(e)]=e,this._updateZoomLevels()},_removeZoomLimit:function(e){var t=r.stamp(e);this._zoomBoundLayers[t]&&(delete this._zoomBoundLayers[t],this._updateZoomLevels())},_updateZoomLevels:function(){var e=Infinity,t=-Infinity,r=this._getZoomSpan();for(var i in this._zoomBoundLayers){var s=this._zoomBoundLayers[i].options;e=s.minZoom===n?e:Math.min(e,s.minZoom),t=s.maxZoom===n?t:Math.max(t,s.maxZoom)}this._layersMaxZoom=t===-Infinity?n:t,this._layersMinZoom=e===Infinity?n:e,r!==this._getZoomSpan()&&this.fire("zoomlevelschange")}}),r.Projection.Mercator={R:6378137,R_MINOR:6356752.314245179,bounds:r.bounds([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(e){var t=Math.PI/180,n=this.R,i=e.lat*t,s=this.R_MINOR/n,o=Math.sqrt(1-s*s),u=o*Math.sin(i),a=Math.tan(Math.PI/4-i/2)/Math.pow((1-u)/(1+u),o/2);return i=-n*Math.log(Math.max(a,1e-10)),new r.Point(e.lng*t*n,i)},unproject:function(e){var t=180/Math.PI,n=this.R,i=this.R_MINOR/n,s=Math.sqrt(1-i*i),o=Math.exp(-e.y/n),u=Math.PI/2-2*Math.atan(o);for(var a=0,f=.1,l;a<15&&Math.abs(f)>1e-7;a++)l=s*Math.sin(u),l=Math.pow((1-l)/(1+l),s/2),f=Math.PI/2-2*Math.atan(o*l)-u,u+=f;return new r.LatLng(u*t,e.x*t/n)}},r.CRS.EPSG3395=r.extend({},r.CRS.Earth,{code:"EPSG:3395",projection:r.Projection.Mercator,transformation:function(){var e=.5/(Math.PI*r.Projection.Mercator.R);return new r.Transformation(e,.5,-e,.5)}()}),r.GridLayer=r.Layer.extend({options:{tileSize:256,opacity:1,updateWhenIdle:r.Browser.mobile,updateWhenZooming:!0,updateInterval:200,attribution:null,zIndex:1,bounds:null,minZoom:0,maxZoom:n,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(e){r.setOptions(this,e)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView(),this._update()},beforeAdd:function(e){e._addZoomLimit(this)},onRemove:function(e){this._removeAllTiles(),r.DomUtil.remove(this._container),e._removeZoomLimit(this),this._container=null,this._tileZoom=null},bringToFront:function(){return this._map&&(r.DomUtil.toFront(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(r.DomUtil.toBack(this._container),this._setAutoZIndex(Math.min)),this},getAttribution:function(){return this.options.attribution},getContainer:function(){return this._container},setOpacity:function(e){return this.options.opacity=e,this._updateOpacity(),this},setZIndex:function(e){return this.options.zIndex=e,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllTiles(),this._update()),this},getEvents:function(){var e={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=r.Util.throttle(this._onMoveEnd,this.options.updateInterval,this)),e.move=this._onMove),this._zoomAnimated&&(e.zoomanim=this._animateZoom),e},createTile:function(){return t.createElement("div")},getTileSize:function(){var e=this.options.tileSize;return e instanceof r.Point?e:new r.Point(e,e)},_updateZIndex:function(){this._container&&this.options.zIndex!==n&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(e){var t=this.getPane().children,n=-e(-Infinity,Infinity);for(var r=0,i=t.length,s;r<i;r++)s=t[r].style.zIndex,t[r]!==this._container&&s&&(n=e(n,+s));isFinite(n)&&(this.options.zIndex=n+e(-1,1),this._updateZIndex())},_updateOpacity:function(){if(!this._map)return;if(r.Browser.ielt9)return;r.DomUtil.setOpacity(this._container,this.options.opacity);var e=+(new Date),t=!1,n=!1;for(var i in this._tiles){var s=this._tiles[i];if(!s.current||!s.loaded)continue;var o=Math.min(1,(e-s.loaded)/200);r.DomUtil.setOpacity(s.el,o),o<1?t=!0:(s.active&&(n=!0),s.active=!0)}n&&!this._noPrune&&this._pruneTiles(),t&&(r.Util.cancelAnimFrame(this._fadeFrame),this._fadeFrame=r.Util.requestAnimFrame(this._updateOpacity,this))},_initContainer:function(){if(this._container)return;this._container=r.DomUtil.create("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container)},_updateLevels:function(){var e=this._tileZoom,t=this.options.maxZoom;if(e===n)return n;for(var i in this._levels)this._levels[i].el.children.length||i===e?this._levels[i].el.style.zIndex=t-Math.abs(e-i):(r.DomUtil.remove(this._levels[i].el),this._removeTilesAtZoom(i),delete this._levels[i]);var s=this._levels[e],o=this._map;return s||(s=this._levels[e]={},s.el=r.DomUtil.create("div","leaflet-tile-container leaflet-zoom-animated",this._container),s.el.style.zIndex=t,s.origin=o.project(o.unproject(o.getPixelOrigin()),e).round(),s.zoom=e,this._setZoomTransform(s,o.getCenter(),o.getZoom()),r.Util.falseFn(s.el.offsetWidth)),this._level=s,s},_pruneTiles:function(){if(!this._map)return;var e,t,n=this._map.getZoom();if(n>this.options.maxZoom||n<this.options.minZoom){this._removeAllTiles();return}for(e in this._tiles)t=this._tiles[e],t.retain=t.current;for(e in this._tiles){t=this._tiles[e];if(t.current&&!t.active){var r=t.coords;this._retainParent(r.x,r.y,r.z,r.z-5)||this._retainChildren(r.x,r.y,r.z,r.z+2)}}for(e in this._tiles)this._tiles[e].retain||this._removeTile(e)},_removeTilesAtZoom:function(e){for(var t in this._tiles){if(this._tiles[t].coords.z!==e)continue;this._removeTile(t)}},_removeAllTiles:function(){for(var e in this._tiles)this._removeTile(e)},_invalidateAll:function(){for(var e in this._levels)r.DomUtil.remove(this._levels[e].el),delete this._levels[e];this._removeAllTiles(),this._tileZoom=null},_retainParent:function(e,t,n,i){var s=Math.floor(e/2),o=Math.floor(t/2),u=n-1,a=new r.Point(+s,+o);a.z=+u;var f=this._tileCoordsToKey(a),l=this._tiles[f];return l&&l.active?(l.retain=!0,!0):(l&&l.loaded&&(l.retain=!0),u>i?this._retainParent(s,o,u,i):!1)},_retainChildren:function(e,t,n,i){for(var s=2*e;s<2*e+2;s++)for(var o=2*t;o<2*t+2;o++){var u=new r.Point(s,o);u.z=n+1;var a=this._tileCoordsToKey(u),f=this._tiles[a];if(f&&f.active){f.retain=!0;continue}f&&f.loaded&&(f.retain=!0),n+1<i&&this._retainChildren(s,o,n+1,i)}},_resetView:function(e){var t=e&&(e.pinch||e.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),t,t)},_animateZoom:function(e){this._setView(e.center,e.zoom,!0,e.noUpdate)},_setView:function(e,t,r,i){var s=Math.round(t);if(this.options.maxZoom!==n&&s>this.options.maxZoom||this.options.minZoom!==n&&s<this.options.minZoom)s=n;var o=this.options.updateWhenZooming&&s!==this._tileZoom;if(!i||o)this._tileZoom=s,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),s!==n&&this._update(e),r||this._pruneTiles(),this._noPrune=!!r;this._setZoomTransforms(e,t)},_setZoomTransforms:function(e,t){for(var n in this._levels)this._setZoomTransform(this._levels[n],e,t)},_setZoomTransform:function(e,t,n){var i=this._map.getZoomScale(n,e.zoom),s=e.origin.multiplyBy(i).subtract(this._map._getNewPixelOrigin(t,n)).round();r.Browser.any3d?r.DomUtil.setTransform(e.el,s,i):r.DomUtil.setPosition(e.el,s)},_resetGrid:function(){var e=this._map,t=e.options.crs,n=this._tileSize=this.getTileSize(),r=this._tileZoom,i=this._map.getPixelWorldBounds(this._tileZoom);i&&(this._globalTileRange=this._pxBoundsToTileRange(i)),this._wrapX=t.wrapLng&&!this.options.noWrap&&[Math.floor(e.project([0,t.wrapLng[0]],r).x/n.x),Math.ceil(e.project([0,t.wrapLng[1]],r).x/n.y)],this._wrapY=t.wrapLat&&!this.options.noWrap&&[Math.floor(e.project([t.wrapLat[0],0],r).y/n.x),Math.ceil(e.project([t.wrapLat[1],0],r).y/n.y)]},_onMoveEnd:function(){if(!this._map||this._map._animatingZoom)return;this._update()},_getTiledPixelBounds:function(e){var t=this._map,n=t._animatingZoom?Math.max(t._animateToZoom,t.getZoom()):t.getZoom(),i=t.getZoomScale(n,this._tileZoom),s=t.project(e,this._tileZoom).floor(),o=t.getSize().divideBy(i*2);return new r.Bounds(s.subtract(o),s.add(o))},_update:function(e){var i=this._map;if(!i)return;var s=i.getZoom();e===n&&(e=i.getCenter());if(this._tileZoom===n)return;var o=this._getTiledPixelBounds(e),u=this._pxBoundsToTileRange(o),a=u.getCenter(),f=[],l=this.options.keepBuffer,c=new r.Bounds(u.getBottomLeft().subtract([l,-l]),u.getTopRight().add([l,-l]));for(var h in this._tiles){var p=this._tiles[h].coords;if(p.z!==this._tileZoom||!c.contains(r.point(p.x,p.y)))this._tiles[h].current=!1}if(Math.abs(s-this._tileZoom)>1){this._setView(e,s);return}for(var d=u.min.y;d<=u.max.y;d++)for(var v=u.min.x;v<=u.max.x;v++){var m=new r.Point(v,d);m.z=this._tileZoom;if(!this._isValidTile(m))continue;var g=this._tiles[this._tileCoordsToKey(m)];g?g.current=!0:f.push(m)}f.sort(function(e,t){return e.distanceTo(a)-t.distanceTo(a)});if(f.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var y=t.createDocumentFragment();for(v=0;v<f.length;v++)this._addTile(f[v],y);this._level.el.appendChild(y)}},_isValidTile:function(e){var t=this._map.options.crs;if(!t.infinite){var n=this._globalTileRange;if(!t.wrapLng&&(e.x<n.min.x||e.x>n.max.x)||!t.wrapLat&&(e.y<n.min.y||e.y>n.max.y))return!1}if(!this.options.bounds)return!0;var i=this._tileCoordsToBounds(e);return r.latLngBounds(this.options.bounds).overlaps(i)},_keyToBounds:function(e){return this._tileCoordsToBounds(this._keyToTileCoords(e))},_tileCoordsToBounds:function(e){var t=this._map,n=this.getTileSize(),i=e.scaleBy(n),s=i.add(n),o=t.unproject(i,e.z),u=t.unproject(s,e.z);return this.options.noWrap||(o=t.wrapLatLng(o),u=t.wrapLatLng(u)),new r.LatLngBounds(o,u)},_tileCoordsToKey:function(e){return e.x+":"+e.y+":"+e.z},_keyToTileCoords:function(e){var t=e.split(":"),n=new r.Point(+t[0],+t[1]);return n.z=+t[2],n},_removeTile:function(e){var t=this._tiles[e];if(!t)return;r.DomUtil.remove(t.el),delete this._tiles[e],this.fire("tileunload",{tile:t.el,coords:this._keyToTileCoords(e)})},_initTile:function(e){r.DomUtil.addClass(e,"leaflet-tile");var t=this.getTileSize();e.style.width=t.x+"px",e.style.height=t.y+"px",e.onselectstart=r.Util.falseFn,e.onmousemove=r.Util.falseFn,r.Browser.ielt9&&this.options.opacity<1&&r.DomUtil.setOpacity(e,this.options.opacity),r.Browser.android&&!r.Browser.android23&&(e.style.WebkitBackfaceVisibility="hidden")},_addTile:function(e,t){var n=this._getTilePos(e),i=this._tileCoordsToKey(e),s=this.createTile(this._wrapCoords(e),r.bind(this._tileReady,this,e));this._initTile(s),this.createTile.length<2&&r.Util.requestAnimFrame(r.bind(this._tileReady,this,e,null,s)),r.DomUtil.setPosition(s,n),this._tiles[i]={el:s,coords:e,current:!0},t.appendChild(s),this.fire("tileloadstart",{tile:s,coords:e})},_tileReady:function(e,t,n){if(!this._map)return;t&&this.fire("tileerror",{error:t,tile:n,coords:e});var i=this._tileCoordsToKey(e);n=this._tiles[i];if(!n)return;n.loaded=+(new Date),this._map._fadeAnimated?(r.DomUtil.setOpacity(n.el,0),r.Util.cancelAnimFrame(this._fadeFrame),this._fadeFrame=r.Util.requestAnimFrame(this._updateOpacity,this)):(n.active=!0,this._pruneTiles()),r.DomUtil.addClass(n.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:n.el,coords:e}),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),r.Browser.ielt9||!this._map._fadeAnimated?r.Util.requestAnimFrame(this._pruneTiles,this):setTimeout(r.bind(this._pruneTiles,this),250))},_getTilePos:function(e){return e.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(e){var t=new r.Point(this._wrapX?r.Util.wrapNum(e.x,this._wrapX):e.x,this._wrapY?r.Util.wrapNum(e.y,this._wrapY):e.y);return t.z=e.z,t},_pxBoundsToTileRange:function(e){var t=this.getTileSize();return new r.Bounds(e.min.unscaleBy(t).floor(),e.max.unscaleBy(t).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var e in this._tiles)if(!this._tiles[e].loaded)return!1;return!0}}),r.gridLayer=function(e){return new r.GridLayer(e)},r.TileLayer=r.GridLayer.extend({options:{minZoom:0,maxZoom:18,maxNativeZoom:null,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},initialize:function(e,t){this._url=e,t=r.setOptions(this,t),t.detectRetina&&r.Browser.retina&&t.maxZoom>0&&(t.tileSize=Math.floor(t.tileSize/2),t.zoomReverse?(t.zoomOffset--,t.minZoom++):(t.zoomOffset++,t.maxZoom--),t.minZoom=Math.max(0,t.minZoom)),typeof t.subdomains=="string"&&(t.subdomains=t.subdomains.split("")),r.Browser.android||this.on("tileunload",this._onTileRemove)},setUrl:function(e,t){return this._url=e,t||this.redraw(),this},createTile:function(e,n){var i=t.createElement("img");return r.DomEvent.on(i,"load",r.bind(this._tileOnLoad,this,n,i)),r.DomEvent.on(i,"error",r.bind(this._tileOnError,this,n,i)),this.options.crossOrigin&&(i.crossOrigin=""),i.alt="",i.src=this.getTileUrl(e),i},getTileUrl:function(e){var t={r:r.Browser.retina?"@2x":"",s:this._getSubdomain(e),x:e.x,y:e.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var n=this._globalTileRange.max.y-e.y;this.options.tms&&(t.y=n),t["-y"]=n}return r.Util.template(this._url,r.extend(t,this.options))},_tileOnLoad:function(e,t){r.Browser.ielt9?setTimeout(r.bind(e,this,null,t),0):e(null,t)},_tileOnError:function(e,t,n){var r=this.options.errorTileUrl;r&&(t.src=r),e(n,t)},getTileSize:function(){var e=this._map,t=r.GridLayer.prototype.getTileSize.call(this),n=this._tileZoom+this.options.zoomOffset,i=this.options.maxNativeZoom;return i!==null&&n>i?t.divideBy(e.getZoomScale(i,n)).round():t},_onTileRemove:function(e){e.tile.onload=null},_getZoomForUrl:function(){var e=this.options,t=this._tileZoom;return e.zoomReverse&&(t=e.maxZoom-t),t+=e.zoomOffset,e.maxNativeZoom!==null?Math.min(t,e.maxNativeZoom):t},_getSubdomain:function(e){var t=Math.abs(e.x+e.y)%this.options.subdomains.length;return this.options.subdomains[t]},_abortLoading:function(){var e,t;for(e in this._tiles)this._tiles[e].coords.z!==this._tileZoom&&(t=this._tiles[e].el,t.onload=r.Util.falseFn,t.onerror=r.Util.falseFn,t.complete||(t.src=r.Util.emptyImageUrl,r.DomUtil.remove(t)))}}),r.tileLayer=function(e,t){return new r.TileLayer(e,t)},r.TileLayer.WMS=r.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(e,t){this._url=e;var n=r.extend({},this.defaultWmsParams);for(var i in t)i in this.options||(n[i]=t[i]);t=r.setOptions(this,t),n.width=n.height=t.tileSize*(t.detectRetina&&r.Browser.retina?2:1),this.wmsParams=n},onAdd:function(e){this._crs=this.options.crs||e.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var t=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[t]=this._crs.code,r.TileLayer.prototype.onAdd.call(this,e)},getTileUrl:function(e){var t=this._tileCoordsToBounds(e),n=this._crs.project(t.getNorthWest()),i=this._crs.project(t.getSouthEast()),s=(this._wmsVersion>=1.3&&this._crs===r.CRS.EPSG4326?[i.y,n.x,n.y,i.x]:[n.x,i.y,i.x,n.y]).join(","),o=r.TileLayer.prototype.getTileUrl.call(this,e);return o+r.Util.getParamString(this.wmsParams,o,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+s},setParams:function(e,t){return r.extend(this.wmsParams,e),t||this.redraw(),this}}),r.tileLayer.wms=function(e,t){return new r.TileLayer.WMS(e,t)},r.ImageOverlay=r.Layer.extend({options:{opacity:1,alt:"",interactive:!1,attribution:null,crossOrigin:!1},initialize:function(e,t,n){this._url=e,this._bounds=r.latLngBounds(t),r.setOptions(this,n)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(r.DomUtil.addClass(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){r.DomUtil.remove(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(e){return this.options.opacity=e,this._image&&this._updateOpacity(),this},setStyle:function(e){return e.opacity&&this.setOpacity(e.opacity),this},bringToFront:function(){return this._map&&r.DomUtil.toFront(this._image),this},bringToBack:function(){return this._map&&r.DomUtil.toBack(this._image),this},setUrl:function(e){return this._url=e,this._image&&(this._image.src=e),this},setBounds:function(e){return this._bounds=e,this._map&&this._reset(),this},getAttribution:function(){return this.options.attribution},getEvents:function(){var e={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(e.zoomanim=this._animateZoom),e},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var e=this._image=r.DomUtil.create("img","leaflet-image-layer "+(this._zoomAnimated?"leaflet-zoom-animated":""));e.onselectstart=r.Util.falseFn,e.onmousemove=r.Util.falseFn,e.onload=r.bind(this.fire,this,"load"),this.options.crossOrigin&&(e.crossOrigin=""),e.src=this._url,e.alt=this.options.alt},_animateZoom:function(e){var t=this._map.getZoomScale(e.zoom),n=this._map._latLngToNewLayerPoint(this._bounds.getNorthWest(),e.zoom,e.center);r.DomUtil.setTransform(this._image,n,t)},_reset:function(){var e=this._image,t=new r.Bounds(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),n=t.getSize();r.DomUtil.setPosition(e,t.min),e.style.width=n.x+"px",e.style.height=n.y+"px"},_updateOpacity:function(){r.DomUtil.setOpacity(this._image,this.options.opacity)}}),r.imageOverlay=function(e,t,n){return new r.ImageOverlay(e,t,n)},r.Icon=r.Class.extend({initialize:function(e){r.setOptions(this,e)},createIcon:function(e){return this._createIcon("icon",e)},createShadow:function(e){return this._createIcon("shadow",e)},_createIcon:function(e,t){var n=this._getIconUrl(e);if(!n){if(e==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var r=this._createImg(n,t&&t.tagName==="IMG"?t:null);return this._setIconStyles(r,e),r},_setIconStyles:function(e,t){var n=this.options,i=n[t+"Size"];typeof i=="number"&&(i=[i,i]);var s=r.point(i),o=r.point(t==="shadow"&&n.shadowAnchor||n.iconAnchor||s&&s.divideBy(2,!0));e.className="leaflet-marker-"+t+" "+(n.className||""),o&&(e.style.marginLeft=-o.x+"px",e.style.marginTop=-o.y+"px"),s&&(e.style.width=s.x+"px",e.style.height=s.y+"px")},_createImg:function(e,n){return n=n||t.createElement("img"),n.src=e,n},_getIconUrl:function(e){return r.Browser.retina&&this.options[e+"RetinaUrl"]||this.options[e+"Url"]}}),r.icon=function(e){return new r.Icon(e)},r.Icon.Default=r.Icon.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(e){return r.Icon.Default.imagePath||(r.Icon.Default.imagePath=this._detectIconPath()),(this.options.imagePath||r.Icon.Default.imagePath)+r.Icon.prototype._getIconUrl.call(this,e)},_detectIconPath:function(){var e=r.DomUtil.create("div","leaflet-default-icon-path",t.body),n=r.DomUtil.getStyle(e,"background-image")||r.DomUtil.getStyle(e,"backgroundImage");return t.body.removeChild(e),n.indexOf("url")===0?n.replace(/^url\([\"\']?/,"").replace(/[\"\']?\)$/,""):""}}),r.Marker=r.Layer.extend({options:{icon:new r.Icon.Default,interactive:!0,draggable:!1,keyboard:!0,title:"",alt:"",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",nonBubblingEvents:["click","dblclick","mouseover","mouseout","contextmenu"]},initialize:function(e,t){r.setOptions(this,t),this._latlng=r.latLng(e)},onAdd:function(e){this._zoomAnimated=this._zoomAnimated&&e.options.markerZoomAnimation,this._zoomAnimated&&e.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(e){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),this._zoomAnimated&&e.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(e){var t=this._latlng;return this._latlng=r.latLng(e),this.update(),this.fire("move",{oldLatLng:t,latlng:this._latlng})},setZIndexOffset:function(e){return this.options.zIndexOffset=e,this.update()},setIcon:function(e){return this.options.icon=e,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon){var e=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(e)}return this},_initIcon:function(){var e=this.options,t="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),n=e.icon.createIcon(this._icon),i=!1;n!==this._icon&&(this._icon&&this._removeIcon(),i=!0,e.title&&(n.title=e.title),e.alt&&(n.alt=e.alt)),r.DomUtil.addClass(n,t),e.keyboard&&(n.tabIndex="0"),this._icon=n,e.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var s=e.icon.createShadow(this._shadow),o=!1;s!==this._shadow&&(this._removeShadow(),o=!0),s&&r.DomUtil.addClass(s,t),this._shadow=s,e.opacity<1&&this._updateOpacity(),i&&this.getPane().appendChild(this._icon),this._initInteraction(),s&&o&&this.getPane("shadowPane").appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),r.DomUtil.remove(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&r.DomUtil.remove(this._shadow),this._shadow=null},_setPos:function(e){r.DomUtil.setPosition(this._icon,e),this._shadow&&r.DomUtil.setPosition(this._shadow,e),this._zIndex=e.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(e){this._icon.style.zIndex=this._zIndex+e},_animateZoom:function(e){var t=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center).round();this._setPos(t)},_initInteraction:function(){if(!this.options.interactive)return;r.DomUtil.addClass(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon);if(r.Handler.MarkerDrag){var e=this.options.draggable;this.dragging&&(e=this.dragging.enabled(),this.dragging.disable()),this.dragging=new r.Handler.MarkerDrag(this),e&&this.dragging.enable()}},setOpacity:function(e){return this.options.opacity=e,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var e=this.options.opacity;r.DomUtil.setOpacity(this._icon,e),this._shadow&&r.DomUtil.setOpacity(this._shadow,e)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)}}),r.marker=function(e,t){return new r.Marker(e,t)},r.DivIcon=r.Icon.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(e){var n=e&&e.tagName==="DIV"?e:t.createElement("div"),i=this.options;n.innerHTML=i.html!==!1?i.html:"";if(i.bgPos){var s=r.point(i.bgPos);n.style.backgroundPosition=-s.x+"px "+ -s.y+"px"}return this._setIconStyles(n,"icon"),n},createShadow:function(){return null}}),r.divIcon=function(e){return new r.DivIcon(e)},r.DivOverlay=r.Layer.extend({options:{offset:[0,7],className:"",pane:"popupPane"},initialize:function(e,t){r.setOptions(this,e),this._source=t},onAdd:function(e){this._zoomAnimated=e._zoomAnimated,this._container||this._initLayout(),e._fadeAnimated&&r.DomUtil.setOpacity(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),e._fadeAnimated&&r.DomUtil.setOpacity(this._container,1),this.bringToFront()},onRemove:function(e){e._fadeAnimated?(r.DomUtil.setOpacity(this._container,0),this._removeTimeout=setTimeout(r.bind(r.DomUtil.remove,r.DomUtil,this._container),200)):r.DomUtil.remove(this._container)},getLatLng:function(){return this._latlng},setLatLng:function(e){return this._latlng=r.latLng(e),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(e){return this._content=e,this.update(),this},getElement:function(){return this._container},update:function(){if(!this._map)return;this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan()},getEvents:function(){var e={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(e.zoomanim=this._animateZoom),e},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&r.DomUtil.toFront(this._container),this},bringToBack:function(){return this._map&&r.DomUtil.toBack(this._container),this},_updateContent:function(){if(!this._content)return;var e=this._contentNode,t=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof t=="string")e.innerHTML=t;else{while(e.hasChildNodes())e.removeChild(e.firstChild);e.appendChild(t)}this.fire("contentupdate")},_updatePosition:function(){if(!this._map)return;var e=this._map.latLngToLayerPoint(this._latlng),t=r.point(this.options.offset),n=this._getAnchor();this._zoomAnimated?r.DomUtil.setPosition(this._container,e.add(n)):t=t.add(e).add(n);var i=this._containerBottom=-t.y,s=this._containerLeft=-Math.round(this._containerWidth/2)+t.x;this._container.style.bottom=i+"px",this._container.style.left=s+"px"},_getAnchor:function(){return[0,0]}}),r.Popup=r.DivOverlay.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,className:""},openOn:function(e){return e.openPopup(this),this},onAdd:function(e){r.DivOverlay.prototype.onAdd.call(this,e),e.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof r.Path||this._source.on("preclick",r.DomEvent.stopPropagation))},onRemove:function(e){r.DivOverlay.prototype.onRemove.call(this,e),e.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof r.Path||this._source.off("preclick",r.DomEvent.stopPropagation))},getEvents:function(){var e=r.DivOverlay.prototype.getEvents.call(this);if("closeOnClick"in this.options?this.options.closeOnClick:this._map.options.closePopupOnClick)e.preclick=this._close;return this.options.keepInView&&(e.moveend=this._adjustPan),e},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var e="leaflet-popup",t=this._container=r.DomUtil.create("div",e+" "+(this.options.className||"")+" leaflet-zoom-animated");if(this.options.closeButton){var n=this._closeButton=r.DomUtil.create("a",e+"-close-button",t);n.href="#close",n.innerHTML="&#215;",r.DomEvent.on(n,"click",this._onCloseButtonClick,this)}var i=this._wrapper=r.DomUtil.create("div",e+"-content-wrapper",t);this._contentNode=r.DomUtil.create("div",e+"-content",i),r.DomEvent.disableClickPropagation(i).disableScrollPropagation(this._contentNode).on(i,"contextmenu",r.DomEvent.stopPropagation),this._tipContainer=r.DomUtil.create("div",e+"-tip-container",t),this._tip=r.DomUtil.create("div",e+"-tip",this._tipContainer)},_updateLayout:function(){var e=this._contentNode,t=e.style;t.width="",t.whiteSpace="nowrap";var n=e.offsetWidth;n=Math.min(n,this.options.maxWidth),n=Math.max(n,this.options.minWidth),t.width=n+1+"px",t.whiteSpace="",t.height="";var i=e.offsetHeight,s=this.options.maxHeight,o="leaflet-popup-scrolled";s&&i>s?(t.height=s+"px",r.DomUtil.addClass(e,o)):r.DomUtil.removeClass(e,o),this._containerWidth=this._container.offsetWidth},_animateZoom:function(e){var t=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center),n=this._getAnchor();r.DomUtil.setPosition(this._container,t.add(n))},_adjustPan:function(){if(!this.options.autoPan||this._map._panAnim&&this._map._panAnim._inProgress)return;var e=this._map,t=parseInt(r.DomUtil.getStyle(this._container,"marginBottom"),10)||0,n=this._container.offsetHeight+t,i=this._containerWidth,s=new r.Point(this._containerLeft,-n-this._containerBottom);s._add(r.DomUtil.getPosition(this._container));var o=e.layerPointToContainerPoint(s),u=r.point(this.options.autoPanPadding),a=r.point(this.options.autoPanPaddingTopLeft||u),f=r.point(this.options.autoPanPaddingBottomRight||u),l=e.getSize(),c=0,h=0;o.x+i+f.x>l.x&&(c=o.x+i-l.x+f.x),o.x-c-a.x<0&&(c=o.x-a.x),o.y+n+f.y>l.y&&(h=o.y+n-l.y+f.y),o.y-h-a.y<0&&(h=o.y-a.y),(c||h)&&e.fire("autopanstart").panBy([c,h])},_onCloseButtonClick:function(e){this._close(),r.DomEvent.stop(e)},_getAnchor:function(){return r.point(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),r.popup=function(e,t){return new r.Popup(e,t)},r.Map.mergeOptions({closePopupOnClick:!0}),r.Map.include({openPopup:function(e,t,n){return e instanceof r.Popup||(e=(new r.Popup(n)).setContent(e)),t&&e.setLatLng(t),this.hasLayer(e)?this:(this._popup&&this._popup.options.autoClose&&this.closePopup(),this._popup=e,this.addLayer(e))},closePopup:function(e){if(!e||e===this._popup)e=this._popup,this._popup=null;return e&&this.removeLayer(e),this}}),r.Layer.include({bindPopup:function(e,t){if(e instanceof r.Popup)r.setOptions(e,t),this._popup=e,e._source=this;else{if(!this._popup||t)this._popup=new r.Popup(t,this);this._popup.setContent(e)}return this._popupHandlersAdded||(this.on({click:this._openPopup,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(e,t){e instanceof r.Layer||(t=e,e=this);if(e instanceof r.FeatureGroup)for(var n in this._layers){e=this._layers[n];break}return t||(t=e.getCenter?e.getCenter():e.getLatLng()),this._popup&&this._map&&(this._popup._source=e,this._popup.update(),this._map.openPopup(this._popup,t)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(e){return this._popup&&(this._popup._map?this.closePopup():this.openPopup(e)),this},isPopupOpen:function(){return this._popup.isOpen()},setPopupContent:function(e){return this._popup&&this._popup.setContent(e),this},getPopup:function(){return this._popup},_openPopup:function(e){var t=e.layer||e.target;if(!this._popup)return;if(!this._map)return;r.DomEvent.stop(e);if(t instanceof r.Path){this.openPopup(e.layer||e.target,e.latlng);return}this._map.hasLayer(this._popup)&&this._popup._source===t?this.closePopup():this.openPopup(t,e.latlng)},_movePopup:function(e){this._popup.setLatLng(e.latlng)}}),r.Marker.include({_getPopupAnchor:function(){return this.options.icon.options.popupAnchor||[0,0]}}),r.Tooltip=r.DivOverlay.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,interactive:!1,opacity:.9},onAdd:function(e){r.DivOverlay.prototype.onAdd.call(this,e),this.setOpacity(this.options.opacity),e.fire("tooltipopen",{tooltip:this}),this._source&&this._source.fire("tooltipopen",{tooltip:this},!0)},onRemove:function(e){r.DivOverlay.prototype.onRemove.call(this,e),e.fire("tooltipclose",{tooltip:this}),this._source&&this._source.fire("tooltipclose",{tooltip:this},!0)},getEvents:function(){var e=r.DivOverlay.prototype.getEvents.call(this);return r.Browser.touch&&!this.options.permanent&&(e.preclick=this._close),e},_close:function(){this._map&&this._map.closeTooltip(this)},_initLayout:function(){var e="leaflet-tooltip",t=e+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=r.DomUtil.create("div",t)},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(e){var t=this._map,n=this._container,i=t.latLngToContainerPoint(t.getCenter()),s=t.layerPointToContainerPoint(e),o=this.options.direction,u=n.offsetWidth,a=n.offsetHeight,f=r.point(this.options.offset),l=this._getAnchor();o==="top"?e=e.add(r.point(-u/2+f.x,-a+f.y+l.y)):o==="bottom"?e=e.subtract(r.point(u/2-f.x,-f.y)):o==="center"?e=e.subtract(r.point(u/2+f.x,a/2-l.y+f.y)):o==="right"||o==="auto"&&s.x<i.x?(o="right",e=e.add([f.x+l.x,l.y-a/2+f.y])):(o="left",e=e.subtract(r.point(u+l.x-f.x,a/2-l.y-f.y))),r.DomUtil.removeClass(n,"leaflet-tooltip-right"),r.DomUtil.removeClass(n,"leaflet-tooltip-left"),r.DomUtil.removeClass(n,"leaflet-tooltip-top"),r.DomUtil.removeClass(n,"leaflet-tooltip-bottom"),r.DomUtil.addClass(n,"leaflet-tooltip-"+o),r.DomUtil.setPosition(n,e)},_updatePosition:function(){var e=this._map.latLngToLayerPoint(this._latlng);this._setPosition(e)},setOpacity:function(e){this.options.opacity=e,this._container&&r.DomUtil.setOpacity(this._container,e)},_animateZoom:function(e){var t=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center);this._setPosition(t)},_getAnchor:function(){return r.point(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),r.tooltip=function(e,t){return new r.Tooltip(e,t)},r.Map.include({openTooltip:function(e,t,n){return e instanceof r.Tooltip||(e=(new r.Tooltip(n)).setContent(e)),t&&e.setLatLng(t),this.hasLayer(e)?this:this.addLayer(e)},closeTooltip:function(e){return e&&this.removeLayer(e),this}}),r.Layer.include({bindTooltip:function(e,t){if(e instanceof r.Tooltip)r.setOptions(e,t),this._tooltip=e,e._source=this;else{if(!this._tooltip||t)this._tooltip=r.tooltip(t,this);this._tooltip.setContent(e)}return this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(e){if(!e&&this._tooltipHandlersAdded)return;var t=e?"off":"on",n={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?n.add=this._openTooltip:(n.mouseover=this._openTooltip,n.mouseout=this.closeTooltip,this._tooltip.options.sticky&&(n.mousemove=this._moveTooltip),r.Browser.touch&&(n.click=this._openTooltip)),this[t](n),this._tooltipHandlersAdded=!e},openTooltip:function(e,t){e instanceof r.Layer||(t=e,e=this);if(e instanceof r.FeatureGroup)for(var n in this._layers){e=this._layers[n];break}return t||(t=e.getCenter?e.getCenter():e.getLatLng()),this._tooltip&&this._map&&(this._tooltip._source=e,this._tooltip.update(),this._map.openTooltip(this._tooltip,t),this._tooltip.options.interactive&&this._tooltip._container&&(r.DomUtil.addClass(this._tooltip._container,"leaflet-clickable"),this.addInteractiveTarget(this._tooltip._container))),this},closeTooltip:function(){return this._tooltip&&(this._tooltip._close(),this._tooltip.options.interactive&&this._tooltip._container&&(r.DomUtil.removeClass(this._tooltip._container,"leaflet-clickable"),this.removeInteractiveTarget(this._tooltip._container))),this},toggleTooltip:function(e){return this._tooltip&&(this._tooltip._map?this.closeTooltip():this.openTooltip(e)),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(e){return this._tooltip&&this._tooltip.setContent(e),this},getTooltip:function(){return this._tooltip},_openTooltip:function(e){var t=e.layer||e.target;if(!this._tooltip||!this._map)return;this.openTooltip(t,this._tooltip.options.sticky?e.latlng:n)},_moveTooltip:function(e){var t=e.latlng,n,r;this._tooltip.options.sticky&&e.originalEvent&&(n=this._map.mouseEventToContainerPoint(e.originalEvent),r=this._map.containerPointToLayerPoint(n),t=this._map.layerPointToLatLng(r)),this._tooltip.setLatLng(t)}}),r.Marker.include({_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor||[0,0]}}),r.LayerGroup=r.Layer.extend({initialize:function(e){this._layers={};var t,n;if(e)for(t=0,n=e.length;t<n;t++)this.addLayer(e[t])},addLayer:function(e){var t=this.getLayerId(e);return this._layers[t]=e,this._map&&this._map.addLayer(e),this},removeLayer:function(e){var t=e in this._layers?e:this.getLayerId(e);return this._map&&this._layers[t]&&this._map.removeLayer(this._layers[t]),delete this._layers[t],this},hasLayer:function(e){return!!e&&(e in this._layers||this.getLayerId(e)in this._layers)},clearLayers:function(){for(var e in this._layers)this.removeLayer(this._layers[e]);return this},invoke:function(e){var t=Array.prototype.slice.call(arguments,1),n,r;for(n in this._layers)r=this._layers[n],r[e]&&r[e].apply(r,t);return this},onAdd:function(e){for(var t in this._layers)e.addLayer(this._layers[t])},onRemove:function(e){for(var t in this._layers)e.removeLayer(this._layers[t])},eachLayer:function(e,t){for(var n in this._layers)e.call(t,this._layers[n]);return this},getLayer:function(e){return this._layers[e]},getLayers:function(){var e=[];for(var t in this._layers)e.push(this._layers[t]);return e},setZIndex:function(e){return this.invoke("setZIndex",e)},getLayerId:function(e){return r.stamp(e)}}),r.layerGroup=function(e){return new r.LayerGroup(e)},r.FeatureGroup=r.LayerGroup.extend({addLayer:function(e){return this.hasLayer(e)?this:(e.addEventParent(this),r.LayerGroup.prototype.addLayer.call(this,e),this.fire("layeradd",{layer:e}))},removeLayer:function(e){return this.hasLayer(e)?(e in this._layers&&(e=this._layers[e]),e.removeEventParent(this),r.LayerGroup.prototype.removeLayer.call(this,e),this.fire("layerremove",{layer:e})):this},setStyle:function(e){return this.invoke("setStyle",e)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var e=new r.LatLngBounds;for(var t in this._layers){var n=this._layers[t];e.extend(n.getBounds?n.getBounds():n.getLatLng())}return e}}),r.featureGroup=function(e){return new r.FeatureGroup(e)},r.Renderer=r.Layer.extend({options:{padding:.1},initialize:function(e){r.setOptions(this,e),r.stamp(this)},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&r.DomUtil.addClass(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update()},onRemove:function(){r.DomUtil.remove(this._container)},getEvents:function(){var e={viewreset:this._reset,zoom:this._onZoom,moveend:this._update};return this._zoomAnimated&&(e.zoomanim=this._onAnimZoom),e},_onAnimZoom:function(e){this._updateTransform(e.center,e.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(e,t){var n=this._map.getZoomScale(t,this._zoom),i=r.DomUtil.getPosition(this._container),s=this._map.getSize().multiplyBy(.5+this.options.padding),o=this._map.project(this._center,t),u=this._map.project(e,t),a=u.subtract(o),f=s.multiplyBy(-n).add(i).add(s).subtract(a);r.Browser.any3d?r.DomUtil.setTransform(this._container,f,n):r.DomUtil.setPosition(this._container,f)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom)},_update:function(){var e=this.options.padding,t=this._map.getSize(),n=this._map.containerPointToLayerPoint(t.multiplyBy(-e)).round();this._bounds=new r.Bounds(n,n.add(t.multiplyBy(1+e*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),r.Map.include({getRenderer:function(e){var t=e.options.renderer||this._getPaneRenderer(e.options.pane)||this.options.renderer||this._renderer;return t||(t=this._renderer=this.options.preferCanvas&&r.canvas()||r.svg()),this.hasLayer(t)||this.addLayer(t),t},_getPaneRenderer:function(e){if(e==="overlayPane"||e===n)return!1;var t=this._paneRenderers[e];return t===n&&(t=r.SVG&&r.svg({pane:e})||r.Canvas&&r.canvas({pane:e}),this._paneRenderers[e]=t),t}}),r.Path=r.Layer.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0},beforeAdd:function(e){this._renderer=e.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this),this._renderer.on("update",this._update,this)},onRemove:function(){this._renderer._removePath(this),this._renderer.off("update",this._update,this)},getEvents:function(){return{zoomend:this._project,viewreset:this._reset}},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(e){return r.setOptions(this,e),this._renderer&&this._renderer._updateStyle(this),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(r.Browser.touch?10:0)}}),r.LineUtil={simplify:function(e,t){if(!t||!e.length)return e.slice();var n=t*t;return e=this._reducePoints(e,n),e=this._simplifyDP(e,n),e},pointToSegmentDistance:function(e,t,n){return Math.sqrt(this._sqClosestPointOnSegment(e,t,n,!0))},closestPointOnSegment:function(e,t,n){return this._sqClosestPointOnSegment(e,t,n)},_simplifyDP:function(e,t){var r=e.length,i=typeof Uint8Array!=n+""?Uint8Array:Array,s=new i(r);s[0]=s[r-1]=1,this._simplifyDPStep(e,s,t,0,r-1);var o,u=[];for(o=0;o<r;o++)s[o]&&u.push(e[o]);return u},_simplifyDPStep:function(e,t,n,r,i){var s=0,o,u,a;for(u=r+1;u<=i-1;u++)a=this._sqClosestPointOnSegment(e[u],e[r],e[i],!0),a>s&&(o=u,s=a);s>n&&(t[o]=1,this._simplifyDPStep(e,t,n,r,o),this._simplifyDPStep(e,t,n,o,i))},_reducePoints:function(e,t){var n=[e[0]];for(var r=1,i=0,s=e.length;r<s;r++)this._sqDist(e[r],e[i])>t&&(n.push(e[r]),i=r);return i<s-1&&n.push(e[s-1]),n},clipSegment:function(e,t,n,r,i){var s=r?this._lastCode:this._getBitCode(e,n),o=this._getBitCode(t,n),u,a,f;this._lastCode=o;for(;;){if(!(s|o))return[e,t];if(s&o)return!1;u=s||o,a=this._getEdgeIntersection(e,t,u,n,i),f=this._getBitCode(a,n),u===s?(e=a,s=f):(t=a,o=f)}},_getEdgeIntersection:function(e,t,n,i,s){var o=t.x-e.x,u=t.y-e.y,a=i.min,f=i.max,l,c;return n&8?(l=e.x+o*(f.y-e.y)/u,c=f.y):n&4?(l=e.x+o*(a.y-e.y)/u,c=a.y):n&2?(l=f.x,c=e.y+u*(f.x-e.x)/o):n&1&&(l=a.x,c=e.y+u*(a.x-e.x)/o),new r.Point(l,c,s)},_getBitCode:function(e,t){var n=0;return e.x<t.min.x?n|=1:e.x>t.max.x&&(n|=2),e.y<t.min.y?n|=4:e.y>t.max.y&&(n|=8),n},_sqDist:function(e,t){var n=t.x-e.x,r=t.y-e.y;return n*n+r*r},_sqClosestPointOnSegment:function(e,t,n,i){var s=t.x,o=t.y,u=n.x-s,a=n.y-o,f=u*u+a*a,l;return f>0&&(l=((e.x-s)*u+(e.y-o)*a)/f,l>1?(s=n.x,o=n.y):l>0&&(s+=u*l,o+=a*l)),u=e.x-s,a=e.y-o,i?u*u+a*a:new r.Point(s,o)}},r.Polyline=r.Path.extend({options:{smoothFactor:1,noClip:!1},initialize:function(e,t){r.setOptions(this,t),this._setLatLngs(e)},getLatLngs:function(){return this._latlngs},setLatLngs:function(e){return this._setLatLngs(e),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(e){var t=Infinity,n=null,i=r.LineUtil._sqClosestPointOnSegment,s,o;for(var u=0,a=this._parts.length;u<a;u++){var f=this._parts[u];for(var l=1,c=f.length;l<c;l++){s=f[l-1],o=f[l];var h=i(e,s,o,!0);h<t&&(t=h,n=i(e,s,o))}}return n&&(n.distance=Math.sqrt(t)),n},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var e,t,n,r,i,s,o,u=this._rings[0],a=u.length;if(!a)return null;for(e=0,t=0;e<a-1;e++)t+=u[e].distanceTo(u[e+1])/2;if(t===0)return this._map.layerPointToLatLng(u[0]);for(e=0,r=0;e<a-1;e++){i=u[e],s=u[e+1],n=i.distanceTo(s),r+=n;if(r>t)return o=(r-t)/n,this._map.layerPointToLatLng([s.x-o*(s.x-i.x),s.y-o*(s.y-i.y)])}},getBounds:function(){return this._bounds},addLatLng:function(e,t){return t=t||this._defaultShape(),e=r.latLng(e),t.push(e),this._bounds.extend(e),this.redraw()},spliceLatLngs:function(){var e=[].splice.apply(this._latlngs,arguments);return this._convertLatLngs(this._latlngs,!0),this.redraw(),e},_setLatLngs:function(e){this._bounds=new r.LatLngBounds,this._latlngs=this._convertLatLngs(e)},_defaultShape:function(){return r.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(e){var t=[],n=r.Polyline._flat(e);for(var i=0,s=e.length;i<s;i++)n?(t[i]=r.latLng(e[i]),this._bounds.extend(t[i])):t[i]=this._convertLatLngs(e[i]);return t},_project:function(){var e=new r.Bounds;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,e);var t=this._clickTolerance(),n=new r.Point(t,t);this._bounds.isValid()&&e.isValid()&&(e.min._subtract(n),e.max._add(n),this._pxBounds=e)},_projectLatlngs:function(e,t,n){var i=e[0]instanceof r.LatLng,s=e.length,o,u;if(i){u=[];for(o=0;o<s;o++)u[o]=this._map.latLngToLayerPoint(e[o]),n.extend(u[o]);t.push(u)}else for(o=0;o<s;o++)this._projectLatlngs(e[o],t,n)},_clipPoints:function(){var e=this._renderer._bounds;this._parts=[];if(!this._pxBounds||!this._pxBounds.intersects(e))return;if(this.options.noClip){this._parts=this._rings;return}var t=this._parts,n,i,s,o,u,a,f;for(n=0,s=0,o=this._rings.length;n<o;n++){f=this._rings[n];for(i=0,u=f.length;i<u-1;i++){a=r.LineUtil.clipSegment(f[i],f[i+1],e,i,!0);if(!a)continue;t[s]=t[s]||[],t[s].push(a[0]);if(a[1]!==f[i+1]||i===u-2)t[s].push(a[1]),s++}}},_simplifyPoints:function(){var e=this._parts,t=this.options.smoothFactor;for(var n=0,i=e.length;n<i;n++)e[n]=r.LineUtil.simplify(e[n],t)},_update:function(){if(!this._map)return;this._clipPoints(),this._simplifyPoints(),this._updatePath()},_updatePath:function(){this._renderer._updatePoly(this)}}),r.polyline=function(e,t){return new r.Polyline(e,t)},r.Polyline._flat=function(e){return!r.Util.isArray(e[0])||typeof e[0][0]!="object"&&typeof e[0][0]!="undefined"},r.PolyUtil={},r.PolyUtil.clipPolygon=function(e,t,n){var i,s=[1,4,2,8],o,u,a,f,l,c,h,p,d=r.LineUtil;for(o=0,c=e.length;o<c;o++)e[o]._code=d._getBitCode(e[o],t);for(a=0;a<4;a++){h=s[a],i=[];for(o=0,c=e.length,u=c-1;o<c;u=o++)f=e[o],l=e[u],f._code&h?l._code&h||(p=d._getEdgeIntersection(l,f,h,t,n),p._code=d._getBitCode(p,t),i.push(p)):(l._code&h&&(p=d._getEdgeIntersection(l,f,h,t,n),p._code=d._getBitCode(p,t),i.push(p)),i.push(f));e=i}return e},r.Polygon=r.Polyline.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var e,t,n,r,i,s,o,u,a,f=this._rings[0],l=f.length;if(!l)return null;s=o=u=0;for(e=0,t=l-1;e<l;t=e++)n=f[e],r=f[t],i=n.y*r.x-r.y*n.x,o+=(n.x+r.x)*i,u+=(n.y+r.y)*i,s+=i*3;return s===0?a=f[0]:a=[o/s,u/s],this._map.layerPointToLatLng(a)},_convertLatLngs:function(e){var t=r.Polyline.prototype._convertLatLngs.call(this,e),n=t.length;return n>=2&&t[0]instanceof r.LatLng&&t[0].equals(t[n-1])&&t.pop(),t},_setLatLngs:function(e){r.Polyline.prototype._setLatLngs.call(this,e),r.Polyline._flat(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return r.Polyline._flat(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var e=this._renderer._bounds,t=this.options.weight,n=new r.Point(t,t);e=new r.Bounds(e.min.subtract(n),e.max.add(n)),this._parts=[];if(!this._pxBounds||!this._pxBounds.intersects(e))return;if(this.options.noClip){this._parts=this._rings;return}for(var i=0,s=this._rings.length,o;i<s;i++)o=r.PolyUtil.clipPolygon(this._rings[i],e,!0),o.length&&this._parts.push(o)},_updatePath:function(){this._renderer._updatePoly(this,!0)}}),r.polygon=function(e,t){return new r.Polygon(e,t)},r.Rectangle=r.Polygon.extend({initialize:function(e,t){r.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(e),t)},setBounds:function(e){return this.setLatLngs(this._boundsToLatLngs(e))},_boundsToLatLngs:function(e){return e=r.latLngBounds(e),[e.getSouthWest(),e.getNorthWest(),e.getNorthEast(),e.getSouthEast()]}}),r.rectangle=function(e,t){return new r.Rectangle(e,t)},r.CircleMarker=r.Path.extend({options:{fill:!0,radius:10},initialize:function(e,t){r.setOptions(this,t),this._latlng=r.latLng(e),this._radius=this.options.radius},setLatLng:function(e){return this._latlng=r.latLng(e),this.redraw(),this.fire("move",{latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(e){return this.options.radius=this._radius=e,this.redraw()},getRadius:function(){return this._radius},setStyle:function(e){var t=e&&e.radius||this._radius;return r.Path.prototype.setStyle.call(this,e),this.setRadius(t),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var e=this._radius,t=this._radiusY||e,n=this._clickTolerance(),i=[e+n,t+n];this._pxBounds=new r.Bounds(this._point.subtract(i),this._point.add(i))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)}}),r.circleMarker=function(e,t){return new r.CircleMarker(e,t)},r.Circle=r.CircleMarker.extend({initialize:function(e,t,n){typeof t=="number"&&(t=r.extend({},n,{radius:t})),r.setOptions(this,t),this._latlng=r.latLng(e);if(isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(e){return this._mRadius=e,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var e=[this._radius,this._radiusY||this._radius];return new r.LatLngBounds(this._map.layerPointToLatLng(this._point.subtract(e)),this._map.layerPointToLatLng(this._point.add(e)))},setStyle:r.Path.prototype.setStyle,_project:function(){var e=this._latlng.lng,t=this._latlng.lat,n=this._map,i=n.options.crs;if(i.distance===r.CRS.Earth.distance){var s=Math.PI/180,o=this._mRadius/r.CRS.Earth.R/s,u=n.project([t+o,e]),a=n.project([t-o,e]),f=u.add(a).divideBy(2),l=n.unproject(f).lat,c=Math.acos((Math.cos(o*s)-Math.sin(t*s)*Math.sin(l*s))/(Math.cos(t*s)*Math.cos(l*s)))/s;if(isNaN(c)||c===0)c=o/Math.cos(Math.PI/180*t);this._point=f.subtract(n.getPixelOrigin()),this._radius=isNaN(c)?0:Math.max(Math.round(f.x-n.project([l,e-c]).x),1),this._radiusY=Math.max(Math.round(f.y-u.y),1)}else{var h=i.unproject(i.project(this._latlng).subtract([this._mRadius,0]));this._point=n.latLngToLayerPoint(this._latlng),this._radius=this._point.x-n.latLngToLayerPoint(h).x}this._updateBounds()}}),r.circle=function(e,t,n){return new r.Circle(e,t,n)},r.SVG=r.Renderer.extend({getEvents:function(){var e=r.Renderer.prototype.getEvents.call(this);return e.zoomstart=this._onZoomStart,e},_initContainer:function(){this._container=r.SVG.create("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=r.SVG.create("g"),this._container.appendChild(this._rootGroup)},_onZoomStart:function(){this._update()},_update:function(){if(this._map._animatingZoom&&this._bounds)return;r.Renderer.prototype._update.call(this);var e=this._bounds,t=e.getSize(),n=this._container;if(!this._svgSize||!this._svgSize.equals(t))this._svgSize=t,n.setAttribute("width",t.x),n.setAttribute("height",t.y);r.DomUtil.setPosition(n,e.min),n.setAttribute("viewBox",[e.min.x,e.min.y,t.x,t.y].join(" ")),this.fire("update")},_initPath:function(e){var t=e._path=r.SVG.create("path");e.options.className&&r.DomUtil.addClass(t,e.options.className),e.options.interactive&&r.DomUtil.addClass(t,"leaflet-interactive"),this._updateStyle(e)},_addPath:function(e){this._rootGroup.appendChild(e._path),e.addInteractiveTarget(e._path)},_removePath:function(e){r.DomUtil.remove(e._path),e.removeInteractiveTarget(e._path)},_updatePath:function(e){e._project(),e._update()},_updateStyle:function(e){var t=e._path,n=e.options;if(!t)return;n.stroke?(t.setAttribute("stroke",n.color),t.setAttribute("stroke-opacity",n.opacity),t.setAttribute("stroke-width",n.weight),t.setAttribute("stroke-linecap",n.lineCap),t.setAttribute("stroke-linejoin",n.lineJoin),n.dashArray?t.setAttribute("stroke-dasharray",n.dashArray):t.removeAttribute("stroke-dasharray"),n.dashOffset?t.setAttribute("stroke-dashoffset",n.dashOffset):t.removeAttribute("stroke-dashoffset")):t.setAttribute("stroke","none"),n.fill?(t.setAttribute("fill",n.fillColor||n.color),t.setAttribute("fill-opacity",n.fillOpacity),t.setAttribute("fill-rule",n.fillRule||"evenodd")):t.setAttribute("fill","none")},_updatePoly:function(e,t){this._setPath(e,r.SVG.pointsToPath(e._parts,t))},_updateCircle:function(e){var t=e._point,n=e._radius,r=e._radiusY||n,i="a"+n+","+r+" 0 1,0 ",s=e._empty()?"M0 0":"M"+(t.x-n)+","+t.y+i+n*2+",0 "+i+ -n*2+",0 ";this._setPath(e,s)},_setPath:function(e,t){e._path.setAttribute("d",t)},_bringToFront:function(e){r.DomUtil.toFront(e._path)},_bringToBack:function(e){r.DomUtil.toBack(e._path)}}),r.extend(r.SVG,{create:function(e){return t.createElementNS("http://www.w3.org/2000/svg",e)},pointsToPath:function(e,t){var n="",i,s,o,u,a,f;for(i=0,o=e.length;i<o;i++){a=e[i];for(s=0,u=a.length;s<u;s++)f=a[s],n+=(s?"L":"M")+f.x+" "+f.y;n+=t?r.Browser.svg?"z":"x":""}return n||"M0 0"}}),r.Browser.svg=!!t.createElementNS&&!!r.SVG.create("svg").createSVGRect,r.svg=function(e){return r.Browser.svg||r.Browser.vml?new r.SVG(e):null},r.Browser.vml=!r.Browser.svg&&function(){try{var e=t.createElement("div");e.innerHTML='<v:shape adj="1"/>';var n=e.firstChild;return n.style.behavior="url(#default#VML)",n&&typeof n.adj=="object"}catch(r){return!1}}(),r.SVG.include(r.Browser.vml?{_initContainer:function(){this._container=r.DomUtil.create("div","leaflet-vml-container")},_update:function(){if(this._map._animatingZoom)return;r.Renderer.prototype._update.call(this)},_initPath:function(e){var t=e._container=r.SVG.create("shape");r.DomUtil.addClass(t,"leaflet-vml-shape "+(this.options.className||"")),t.coordsize="1 1",e._path=r.SVG.create("path"),t.appendChild(e._path),this._updateStyle(e)},_addPath:function(e){var t=e._container;this._container.appendChild(t),e.options.interactive&&e.addInteractiveTarget(t)},_removePath:function(e){var t=e._container;r.DomUtil.remove(t),e.removeInteractiveTarget(t)},_updateStyle:function(e){var t=e._stroke,n=e._fill,i=e.options,s=e._container;s.stroked=!!i.stroke,s.filled=!!i.fill,i.stroke?(t||(t=e._stroke=r.SVG.create("stroke")),s.appendChild(t),t.weight=i.weight+"px",t.color=i.color,t.opacity=i.opacity,i.dashArray?t.dashStyle=r.Util.isArray(i.dashArray)?i.dashArray.join(" "):i.dashArray.replace(/( *, *)/g," "):t.dashStyle="",t.endcap=i.lineCap.replace("butt","flat"),t.joinstyle=i.lineJoin):t&&(s.removeChild(t),e._stroke=null),i.fill?(n||(n=e._fill=r.SVG.create("fill")),s.appendChild(n),n.color=i.fillColor||i.color,n.opacity=i.fillOpacity):n&&(s.removeChild(n),e._fill=null)},_updateCircle:function(e){var t=e._point.round(),n=Math.round(e._radius),r=Math.round(e._radiusY||n);this._setPath(e,e._empty()?"M0 0":"AL "+t.x+","+t.y+" "+n+","+r+" 0,"+23592600)},_setPath:function(e,t){e._path.v=t},_bringToFront:function(e){r.DomUtil.toFront(e._container)},_bringToBack:function(e){r.DomUtil.toBack(e._container)}}:{}),r.Browser.vml&&(r.SVG.create=function(){try{return t.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(e){return t.createElement("<lvml:"+e+' class="lvml">')}}catch(e){return function(e){return t.createElement("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}()),r.Canvas=r.Renderer.extend({onAdd:function(){r.Renderer.prototype.onAdd.call(this),this._layers=this._layers||{},this._draw()},_initContainer:function(){var e=this._container=t.createElement("canvas");r.DomEvent.on(e,"mousemove",r.Util.throttle(this._onMouseMove,32,this),this).on(e,"click dblclick mousedown mouseup contextmenu",this._onClick,this).on(e,"mouseout",this._handleMouseOut,this),this._ctx=e.getContext("2d")},_update:function(){if(this._map._animatingZoom&&this._bounds)return;this._drawnLayers={},r.Renderer.prototype._update.call(this);var e=this._bounds,t=this._container,n=e.getSize(),i=r.Browser.retina?2:1;r.DomUtil.setPosition(t,e.min),t.width=i*n.x,t.height=i*n.y,t.style.width=n.x+"px",t.style.height=n.y+"px",r.Browser.retina&&this._ctx.scale(2,2),this._ctx.translate(-e.min.x,-e.min.y),this.fire("update")},_initPath:function(e){this._updateDashArray(e),this._layers[r.stamp(e)]=e},_addPath:r.Util.falseFn,_removePath:function(e){e._removed=!0,this._requestRedraw(e)},_updatePath:function(e){this._redrawBounds=e._pxBounds,this._draw(!0),e._project(),e._update(),this._draw(),this._redrawBounds=null},_updateStyle:function(e){this._updateDashArray(e),this._requestRedraw(e)},_updateDashArray:function(e){if(e.options.dashArray){var t=e.options.dashArray.split(","),n=[],r;for(r=0;r<t.length;r++)n.push(Number(t[r]));e.options._dashArray=n}},_requestRedraw:function(e){if(!this._map)return;var t=(e.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new r.Bounds,this._redrawBounds.extend(e._pxBounds.min.subtract([t,t])),this._redrawBounds.extend(e._pxBounds.max.add([t,t])),this._redrawRequest=this._redrawRequest||r.Util.requestAnimFrame(this._redraw,this)},_redraw:function(){this._redrawRequest=null,this._draw(!0),this._draw(),this._redrawBounds=null},_draw:function(e){this._clear=e;var t,n=this._redrawBounds;this._ctx.save(),n&&(this._ctx.beginPath(),this._ctx.rect(n.min.x,n.min.y,n.max.x-n.min.x,n.max.y-n.min.y),this._ctx.clip());for(var r in this._layers)t=this._layers[r],(!n||t._pxBounds&&t._pxBounds.intersects(n))&&t._updatePath(),e&&t._removed&&(delete t._removed,delete this._layers[r]);this._ctx.restore()},_updatePoly:function(e,t){var n,r,i,s,o=e._parts,u=o.length,a=this._ctx;if(!u)return;this._drawnLayers[e._leaflet_id]=e,a.beginPath(),a.setLineDash&&a.setLineDash(e.options&&e.options._dashArray||[]);for(n=0;n<u;n++){for(r=0,i=o[n].length;r<i;r++)s=o[n][r],a[r?"lineTo":"moveTo"](s.x,s.y);t&&a.closePath()}this._fillStroke(a,e)},_updateCircle:function(e){if(e._empty())return;var t=e._point,n=this._ctx,r=e._radius,i=(e._radiusY||r)/r;this._drawnLayers[e._leaflet_id]=e,i!==1&&(n.save(),n.scale(1,i)),n.beginPath(),n.arc(t.x,t.y/i,r,0,Math.PI*2,!1),i!==1&&n.restore(),this._fillStroke(n,e)},_fillStroke:function(e,t){var n=this._clear,r=t.options;e.globalCompositeOperation=n?"destination-out":"source-over",r.fill&&(e.globalAlpha=n?1:r.fillOpacity,e.fillStyle=r.fillColor||r.color,e.fill(r.fillRule||"evenodd")),r.stroke&&r.weight!==0&&(e.globalAlpha=n?1:r.opacity,t._prevWeight=e.lineWidth=n?t._prevWeight+1:r.weight,e.strokeStyle=r.color,e.lineCap=r.lineCap,e.lineJoin=r.lineJoin,e.stroke())},_onClick:function(e){var t=this._map.mouseEventToLayerPoint(e),n=[],i;for(var s in this._layers)i=this._layers[s],i.options.interactive&&i._containsPoint(t)&&!this._map._draggableMoved(i)&&(r.DomEvent._fakeStop(e),n.push(i));n.length&&this._fireEvent(n,e)},_onMouseMove:function(e){if(!this._map||this._map.dragging.moving()||this._map._animatingZoom)return;var t=this._map.mouseEventToLayerPoint(e);this._handleMouseOut(e,t),this._handleMouseHover(e,t)},_handleMouseOut:function(e,t){var n=this._hoveredLayer;n&&(e.type==="mouseout"||!n._containsPoint(t))&&(r.DomUtil.removeClass(this._container,"leaflet-interactive"),this._fireEvent([n],e,"mouseout"),this._hoveredLayer=null)},_handleMouseHover:function(e,t){var n,i;for(n in this._drawnLayers)i=this._drawnLayers[n],i.options.interactive&&i._containsPoint(t)&&(r.DomUtil.addClass(this._container,"leaflet-interactive"),this._fireEvent([i],e,"mouseover"),this._hoveredLayer=i);this._hoveredLayer&&this._fireEvent([this._hoveredLayer],e)},_fireEvent:function(e,t,n){this._map._fireDOMEvent(t,n||t.type,e)},_bringToFront:r.Util.falseFn,_bringToBack:r.Util.falseFn}),r.Browser.canvas=function(){return!!t.createElement("canvas").getContext}(),r.canvas=function(e){return r.Browser.canvas?new r.Canvas(e):null},r.Polyline.prototype._containsPoint=function(e,t){var n,i,s,o,u,a,f=this._clickTolerance();if(!this._pxBounds.contains(e))return!1;for(n=0,o=this._parts.length;n<o;n++){a=this._parts[n];for(i=0,u=a.length,s=u-1;i<u;s=i++){if(!t&&i===0)continue;if(r.LineUtil.pointToSegmentDistance(e,a[s],a[i])<=f)return!0}}return!1},r.Polygon.prototype._containsPoint=function(e){var t=!1,n,i,s,o,u,a,f,l;if(!this._pxBounds.contains(e))return!1;for(o=0,f=this._parts.length;o<f;o++){n=this._parts[o];for(u=0,l=n.length,a=l-1;u<l;a=u++)i=n[u],s=n[a],i.y>e.y!=s.y>e.y&&e.x<(s.x-i.x)*(e.y-i.y)/(s.y-i.y)+i.x&&(t=!t)}return t||r.Polyline.prototype._containsPoint.call(this,e,!0)},r.CircleMarker.prototype._containsPoint=function(e){return e.distanceTo(this._point)<=this._radius+this._clickTolerance()},r.GeoJSON=r.FeatureGroup.extend({initialize:function(e,t){r.setOptions(this,t),this._layers={},e&&this.addData(e)},addData:function(e){var t=r.Util.isArray(e)?e:e.features,n,i,s;if(t){for(n=0,i=t.length;n<i;n++)s=t[n],(s.geometries||s.geometry||s.features||s.coordinates)&&this.addData(s);return this}var o=this.options;if(o.filter&&!o.filter(e))return this;var u=r.GeoJSON.geometryToLayer(e,o);return u?(u.feature=r.GeoJSON.asFeature(e),u.defaultOptions=u.options,this.resetStyle(u),o.onEachFeature&&o.onEachFeature(e,u),this.addLayer(u)):this},resetStyle:function(e){return e.options=r.Util.extend({},e.defaultOptions),this._setLayerStyle(e,this.options.style),this},setStyle:function(e){return this.eachLayer(function(t){this._setLayerStyle(t,e)},this)},_setLayerStyle:function(e,t){typeof t=="function"&&(t=t(e.feature)),e.setStyle&&e.setStyle(t)}}),r.extend(r.GeoJSON,{geometryToLayer:function(e,t){var n=e.type==="Feature"?e.geometry:e,i=n?n.coordinates:null,s=[],o=t&&t.pointToLayer,u=t&&t.coordsToLatLng||this.coordsToLatLng,a,f,l,c;if(!i&&!n)return null;switch(n.type){case"Point":return a=u(i),o?o(e,a):new r.Marker(a);case"MultiPoint":for(l=0,c=i.length;l<c;l++)a=u(i[l]),s.push(o?o(e,a):new r.Marker(a));return new r.FeatureGroup(s);case"LineString":case"MultiLineString":return f=this.coordsToLatLngs(i,n.type==="LineString"?0:1,u),new r.Polyline(f,t);case"Polygon":case"MultiPolygon":return f=this.coordsToLatLngs(i,n.type==="Polygon"?1:2,u),new r.Polygon(f,t);case"GeometryCollection":for(l=0,c=n.geometries.length;l<c;l++){var h=this.geometryToLayer({geometry:n.geometries[l],type:"Feature",properties:e.properties},t);h&&s.push(h)}return new r.FeatureGroup(s);default:throw new Error("Invalid GeoJSON object.")}},coordsToLatLng:function(e){return new r.LatLng(e[1],e[0],e[2])},coordsToLatLngs:function(e,t,n){var r=[];for(var i=0,s=e.length,o;i<s;i++)o=t?this.coordsToLatLngs(e[i],t-1,n):(n||this.coordsToLatLng)(e[i]),r.push(o);return r},latLngToCoords:function(e){return e.alt!==n?[e.lng,e.lat,e.alt]:[e.lng,e.lat]},latLngsToCoords:function(e,t,n){var i=[];for(var s=0,o=e.length;s<o;s++)i.push(t?r.GeoJSON.latLngsToCoords(e[s],t-1,n):r.GeoJSON.latLngToCoords(e[s]));return!t&&n&&i.push(i[0]),i},getFeature:function(e,t){return e.feature?r.extend({},e.feature,{geometry:t}):r.GeoJSON.asFeature(t)},asFeature:function(e){return e.type==="Feature"?e:{type:"Feature",properties:{},geometry:e}}});var o={toGeoJSON:function(){return r.GeoJSON.getFeature(this,{type:"Point",coordinates:r.GeoJSON.latLngToCoords(this.getLatLng())})}};r.Marker.include(o),r.Circle.include(o),r.CircleMarker.include(o),r.Polyline.prototype.toGeoJSON=function(){var e=!r.Polyline._flat(this._latlngs),t=r.GeoJSON.latLngsToCoords(this._latlngs,e?1:0);return r.GeoJSON.getFeature(this,{type:(e?"Multi":"")+"LineString",coordinates:t})},r.Polygon.prototype.toGeoJSON=function(){var e=!r.Polyline._flat(this._latlngs),t=e&&!r.Polyline._flat(this._latlngs[0]),n=r.GeoJSON.latLngsToCoords(this._latlngs,t?2:e?1:0,!0);return e||(n=[n]),r.GeoJSON.getFeature(this,{type:(t?"Multi":"")+"Polygon",coordinates:n})},r.LayerGroup.include({toMultiPoint:function(){var e=[];return this.eachLayer(function(t){e.push(t.toGeoJSON().geometry.coordinates)}),r.GeoJSON.getFeature(this,{type:"MultiPoint",coordinates:e})},toGeoJSON:function(){var e=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(e==="MultiPoint")return this.toMultiPoint();var t=e==="GeometryCollection",n=[];return this.eachLayer(function(e){if(e.toGeoJSON){var i=e.toGeoJSON();n.push(t?i.geometry:r.GeoJSON.asFeature(i))}}),t?r.GeoJSON.getFeature(this,{geometries:n,type:"GeometryCollection"}):{type:"FeatureCollection",features:n}}}),r.geoJSON=function(e,t){return new r.GeoJSON(e,t)},r.geoJson=r.geoJSON;var u="_leaflet_events";r.DomEvent={on:function(e,t,n,i){if(typeof t=="object")for(var s in t)this._on(e,s,t[s],n);else{t=r.Util.splitWords(t);for(var o=0,u=t.length;o<u;o++)this._on(e,t[o],n,i)}return this},off:function(e,t,n,i){if(typeof t=="object")for(var s in t)this._off(e,s,t[s],n);else{t=r.Util.splitWords(t);for(var o=0,u=t.length;o<u;o++)this._off(e,t[o],n,i)}return this},_on:function(t,n,i,s){var o=n+r.stamp(i)+(s?"_"+r.stamp(s):"");if(t[u]&&t[u][o])return this;var a=function(n){return i.call(s||t,n||e.event)},f=a;return r.Browser.pointer&&n.indexOf("touch")===0?this.addPointerListener(t,n,a,o):r.Browser.touch&&n==="dblclick"&&this.addDoubleTapListener?this.addDoubleTapListener(t,a,o):"addEventListener"in t?n==="mousewheel"?t.addEventListener("onwheel"in t?"wheel":"mousewheel",a,!1):n==="mouseenter"||n==="mouseleave"?(a=function(n){n=n||e.event,r.DomEvent._isExternalTarget(t,n)&&f(n)},t.addEventListener(n==="mouseenter"?"mouseover":"mouseout",a,!1)):(n==="click"&&r.Browser.android&&(a=function(e){return r.DomEvent._filterClick(e,f)}),t.addEventListener(n,a,!1)):"attachEvent"in t&&t.attachEvent("on"+n,a),t[u]=t[u]||{},t[u][o]=a,this},_off:function(e,t,n,i){var s=t+r.stamp(n)+(i?"_"+r.stamp(i):""),o=e[u]&&e[u][s];return o?(r.Browser.pointer&&t.indexOf("touch")===0?this.removePointerListener(e,t,s):r.Browser.touch&&t==="dblclick"&&this.removeDoubleTapListener?this.removeDoubleTapListener(e,s):"removeEventListener"in e?t==="mousewheel"?e.removeEventListener("onwheel"in e?"wheel":"mousewheel",o,!1):e.removeEventListener(t==="mouseenter"?"mouseover":t==="mouseleave"?"mouseout":t,o,!1):"detachEvent"in e&&e.detachEvent("on"+t,o),e[u][s]=null,this):this},stopPropagation:function(e){return e.stopPropagation?e.stopPropagation():e.originalEvent?e.originalEvent._stopped=!0:e.cancelBubble=!0,r.DomEvent._skipped(e),this},disableScrollPropagation:function(e){return r.DomEvent.on(e,"mousewheel",r.DomEvent.stopPropagation)},disableClickPropagation:function(e){var t=r.DomEvent.stopPropagation;return r.DomEvent.on(e,r.Draggable.START.join(" "),t),r.DomEvent.on(e,{click:r.DomEvent._fakeStop,dblclick:t})},preventDefault:function(e){return e.preventDefault?e.preventDefault():e.returnValue=!1,this},stop:function(e){return r.DomEvent.preventDefault(e).stopPropagation(e)},getMousePosition:function(e,t){if(!t)return new r.Point(e.clientX,e.clientY);var n=t.getBoundingClientRect();return new r.Point(e.clientX-n.left-t.clientLeft,e.clientY-n.top-t.clientTop)},_wheelPxFactor:r.Browser.win&&r.Browser.chrome?2:r.Browser.gecko?e.devicePixelRatio:1,getWheelDelta:function(e){return r.Browser.edge?e.wheelDeltaY/2:e.deltaY&&e.deltaMode===0?-e.deltaY/r.DomEvent._wheelPxFactor:e.deltaY&&e.deltaMode===1?-e.deltaY*20:e.deltaY&&e.deltaMode===2?-e.deltaY*60:e.deltaX||e.deltaZ?0:e.wheelDelta?(e.wheelDeltaY||e.wheelDelta)/2:e.detail&&Math.abs(e.detail)<32765?-e.detail*20:e.detail?e.detail/-32765*60:0},_skipEvents:{},_fakeStop:function(e){r.DomEvent._skipEvents[e.type]=!0},_skipped:function(e){var t=this._skipEvents[e.type];return this._skipEvents[e.type]=!1,t},_isExternalTarget:function(e,t){var n=t.relatedTarget;if(!n)return!0;try{while(n&&n!==e)n=n.parentNode}catch(r){return!1}return n!==e},_filterClick:function(e,t){var n=e.timeStamp||e.originalEvent&&e.originalEvent.timeStamp,i=r.DomEvent._lastClick&&n-r.DomEvent._lastClick;if(i&&i>100&&i<500||e.target._simulatedClick&&!e._simulated){r.DomEvent.stop(e);return}r.DomEvent._lastClick=n,t(e)}},r.DomEvent.addListener=r.DomEvent.on,r.DomEvent.removeListener=r.DomEvent.off,r.Draggable=r.Evented.extend({options:{clickTolerance:3},statics:{START:r.Browser.touch?["touchstart","mousedown"]:["mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},MOVE:{mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"}},initialize:function(e,t,n){this._element=e,this._dragStartTarget=t||e,this._preventOutline=n},enable:function(){if(this._enabled)return;r.DomEvent.on(this._dragStartTarget,r.Draggable.START.join(" "),this._onDown,this),this._enabled=!0},disable:function(){if(!this._enabled)return;r.DomEvent.off(this._dragStartTarget,r.Draggable.START.join(" "),this._onDown,this),this._enabled=!1,this._moved=!1},_onDown:function(e){if(e._simulated||!this._enabled)return;this._moved=!1;if(r.DomUtil.hasClass(this._element,"leaflet-zoom-anim"))return;if(r.Draggable._dragging||e.shiftKey||e.which!==1&&e.button!==1&&!e.touches||!this._enabled)return;r.Draggable._dragging=!0,this._preventOutline&&r.DomUtil.preventOutline(this._element),r.DomUtil.disableImageDrag(),r.DomUtil.disableTextSelection();if(this._moving)return;this.fire("down");var n=e.touches?e.touches[0]:e;this._startPoint=new r.Point(n.clientX,n.clientY),r.DomEvent.on(t,r.Draggable.MOVE[e.type],this._onMove,this).on(t,r.Draggable.END[e.type],this._onUp,this)},_onMove:function(n){if(n._simulated||!this._enabled)return;if(n.touches&&n.touches.length>1){this._moved=!0;return}var i=n.touches&&n.touches.length===1?n.touches[0]:n,s=new r.Point(i.clientX,i.clientY),o=s.subtract(this._startPoint);if(!o.x&&!o.y)return;if(Math.abs(o.x)+Math.abs(o.y)<this.options.clickTolerance)return;r.DomEvent.preventDefault(n),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=r.DomUtil.getPosition(this._element).subtract(o),r.DomUtil.addClass(t.body,"leaflet-dragging"),this._lastTarget=n.target||n.srcElement,e.SVGElementInstance&&this._lastTarget instanceof SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),r.DomUtil.addClass(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(o),this._moving=!0,r.Util.cancelAnimFrame(this._animRequest),this._lastEvent=n,this._animRequest=r.Util.requestAnimFrame(this._updatePosition,this,!0)},_updatePosition:function(){var e={originalEvent:this._lastEvent};this.fire("predrag",e),r.DomUtil.setPosition(this._element,this._newPos),this.fire("drag",e)},_onUp:function(e){if(e._simulated||!this._enabled)return;r.DomUtil.removeClass(t.body,"leaflet-dragging"),this._lastTarget&&(r.DomUtil.removeClass(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null);for(var n in r.Draggable.MOVE)r.DomEvent.off(t,r.Draggable.MOVE[n],this._onMove,this).off(t,r.Draggable.END[n],this._onUp,this);r.DomUtil.enableImageDrag(),r.DomUtil.enableTextSelection(),this._moved&&this._moving&&(r.Util.cancelAnimFrame(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1,r.Draggable._dragging=!1}}),r.Handler=r.Class.extend({initialize:function(e){this._map=e},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}}),r.Map.mergeOptions({dragging:!0,inertia:!r.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:Infinity,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0}),r.Map.Drag=r.Handler.extend({addHooks:function(){if(!this._draggable){var e=this._map;this._draggable=new r.Draggable(e._mapPane,e._container),this._draggable.on({down:this._onDown,dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),e.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),e.on("zoomend",this._onZoomEnd,this),e.whenReady(this._onZoomEnd,this))}r.DomUtil.addClass(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){r.DomUtil.removeClass(this._map._container,"leaflet-grab"),r.DomUtil.removeClass(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDown:function(){this._map._stop()},_onDragStart:function(){var e=this._map;if(this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var t=r.latLngBounds(this._map.options.maxBounds);this._offsetLimit=r.bounds(this._map.latLngToContainerPoint(t.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(t.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;e.fire("movestart").fire("dragstart"),e.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(e){if(this._map.options.inertia){var t=this._lastTime=+(new Date),n=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(n),this._times.push(t),t-this._times[0]>50&&(this._positions.shift(),this._times.shift())}this._map.fire("move",e).fire("drag",e)},_onZoomEnd:function(){var e=this._map.getSize().divideBy(2),t=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=t.subtract(e).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(e,t){return e-(e-t)*this._viscosity},_onPreDragLimit:function(){if(!this._viscosity||!this._offsetLimit)return;var e=this._draggable._newPos.subtract(this._draggable._startPos),t=this._offsetLimit;e.x<t.min.x&&(e.x=this._viscousLimit(e.x,t.min.x)),e.y<t.min.y&&(e.y=this._viscousLimit(e.y,t.min.y)),e.x>t.max.x&&(e.x=this._viscousLimit(e.x,t.max.x)),e.y>t.max.y&&(e.y=this._viscousLimit(e.y,t.max.y)),this._draggable._newPos=this._draggable._startPos.add(e)},_onPreDragWrap:function(){var e=this._worldWidth,t=Math.round(e/2),n=this._initialWorldOffset,r=this._draggable._newPos.x,i=(r-t+n)%e+t-n,s=(r+t+n)%e-t-n,o=Math.abs(i+n)<Math.abs(s+n)?i:s;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=o},_onDragEnd:function(e){var t=this._map,n=t.options,i=!n.inertia||this._times.length<2;t.fire("dragend",e);if(i)t.fire("moveend");else{var s=this._lastPos.subtract(this._positions[0]),o=(this._lastTime-this._times[0])/1e3,u=n.easeLinearity,a=s.multiplyBy(u/o),f=a.distanceTo([0,0]),l=Math.min(n.inertiaMaxSpeed,f),c=a.multiplyBy(l/f),h=l/(n.inertiaDeceleration*u),p=c.multiplyBy(-h/2).round();!p.x&&!p.y?t.fire("moveend"):(p=t._limitOffset(p,t.options.maxBounds),r.Util.requestAnimFrame(function(){t.panBy(p,{duration:h,easeLinearity:u,noMoveStart:!0,animate:!0})}))}}}),r.Map.addInitHook("addHandler","dragging",r.Map.Drag),r.Map.mergeOptions({doubleClickZoom:!0}),r.Map.DoubleClickZoom=r.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(e){var t=this._map,n=t.getZoom(),r=t.options.zoomDelta,i=e.originalEvent.shiftKey?n-r:n+r;t.options.doubleClickZoom==="center"?t.setZoom(i):t.setZoomAround(e.containerPoint,i)}}),r.Map.addInitHook("addHandler","doubleClickZoom",r.Map.DoubleClickZoom),r.Map.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60}),r.Map.ScrollWheelZoom=r.Handler.extend({addHooks:function(){r.DomEvent.on(this._map._container,"mousewheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){r.DomEvent.off(this._map._container,"mousewheel",this._onWheelScroll,this)},_onWheelScroll:function(e){var t=r.DomEvent.getWheelDelta(e),n=this._map.options.wheelDebounceTime;this._delta+=t,this._lastMousePos=this._map.mouseEventToContainerPoint(e),this._startTime||(this._startTime=+(new Date));var i=Math.max(n-(+(new Date)-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(r.bind(this._performZoom,this),i),r.DomEvent.stop(e)},_performZoom:function(){var e=this._map,t=e.getZoom(),n=this._map.options.zoomSnap||0;e._stop();var r=this._delta/(this._map.options.wheelPxPerZoomLevel*4),i=4*Math.log(2/(1+Math.exp(-Math.abs(r))))/Math.LN2,s=n?Math.ceil(i/n)*n:i,o=e._limitZoom(t+(this._delta>0?s:-s))-t;this._delta=0,this._startTime=null;if(!o)return;e.options.scrollWheelZoom==="center"?e.setZoom(t+o):e.setZoomAround(this._lastMousePos,t+o)}}),r.Map.addInitHook("addHandler","scrollWheelZoom",r.Map.ScrollWheelZoom),r.extend(r.DomEvent,{_touchstart:r.Browser.msPointer?"MSPointerDown":r.Browser.pointer?"pointerdown":"touchstart",_touchend:r.Browser.msPointer?"MSPointerUp":r.Browser.pointer?"pointerup":"touchend",addDoubleTapListener:function(e,t,n){function a(e){var t;r.Browser.pointer?t=r.DomEvent._pointersCount:t=e.touches.length;if(t>1)return;var n=Date.now(),a=n-(i||n);s=e.touches?e.touches[0]:e,o=a>0&&a<=u,i=n}function f(){if(o&&!s.cancelBubble){if(r.Browser.pointer){var e={},n,u;for(u in s)n=s[u],e[u]=n&&n.bind?n.bind(s):n;s=e}s.type="dblclick",t(s),i=null}}var i,s,o=!1,u=250,l="_leaflet_",c=this._touchstart,h=this._touchend;return e[l+c+n]=a,e[l+h+n]=f,e[l+"dblclick"+n]=t,e.addEventListener(c,a,!1),e.addEventListener(h,f,!1),r.Browser.edge||e.addEventListener("dblclick",t,!1),this},removeDoubleTapListener:function(e,t){var n="_leaflet_",i=e[n+this._touchstart+t],s=e[n+this._touchend+t],o=e[n+"dblclick"+t];return e.removeEventListener(this._touchstart,i,!1),e.removeEventListener(this._touchend,s,!1),r.Browser.edge||e.removeEventListener("dblclick",o,!1),this}}),r.extend(r.DomEvent,{POINTER_DOWN:r.Browser.msPointer?"MSPointerDown":"pointerdown",POINTER_MOVE:r.Browser.msPointer?"MSPointerMove":"pointermove",POINTER_UP:r.Browser.msPointer?"MSPointerUp":"pointerup",POINTER_CANCEL:r.Browser.msPointer?"MSPointerCancel":"pointercancel",TAG_WHITE_LIST:["INPUT","SELECT","OPTION"],_pointers:{},_pointersCount:0,addPointerListener:function(e,t,n,r){return t==="touchstart"?this._addPointerStart(e,n,r):t==="touchmove"?this._addPointerMove(e,n,r):t==="touchend"&&this._addPointerEnd(e,n,r),this},removePointerListener:function(e,t,n){var r=e["_leaflet_"+t+n];return t==="touchstart"?e.removeEventListener(this.POINTER_DOWN,r,!1):t==="touchmove"?e.removeEventListener(this.POINTER_MOVE,r,!1):t==="touchend"&&(e.removeEventListener(this.POINTER_UP,r,!1),e.removeEventListener(this.POINTER_CANCEL,r,!1)),this},_addPointerStart:function(e,n,i){var s=r.bind(function(e){if(e.pointerType!=="mouse"&&e.pointerType!==e.MSPOINTER_TYPE_MOUSE){if(!(this.TAG_WHITE_LIST.indexOf(e.target.tagName)<0))return;r.DomEvent.preventDefault(e)}this._handlePointer(e,n)},this);e["_leaflet_touchstart"+i]=s,e.addEventListener(this.POINTER_DOWN,s,!1);if(!this._pointerDocListener){var o=r.bind(this._globalPointerUp,this);t.documentElement.addEventListener(this.POINTER_DOWN,r.bind(this._globalPointerDown,this),!0),t.documentElement.addEventListener(this.POINTER_MOVE,r.bind(this._globalPointerMove,this),!0),t.documentElement.addEventListener(this.POINTER_UP,o,!0),t.documentElement.addEventListener(this.POINTER_CANCEL,o,!0),this._pointerDocListener=!0}},_globalPointerDown:function(e){this._pointers[e.pointerId]=e,this._pointersCount++},_globalPointerMove:function(e){this._pointers[e.pointerId]&&(this._pointers[e.pointerId]=e)},_globalPointerUp:function(e){delete this._pointers[e.pointerId],this._pointersCount--},_handlePointer:function(e,t){e.touches=[];for(var n in this._pointers)e.touches.push(this._pointers[n]);e.changedTouches=[e],t(e)},_addPointerMove:function(e,t,n){var i=r.bind(function(e){if((e.pointerType===e.MSPOINTER_TYPE_MOUSE||e.pointerType==="mouse")&&e.buttons===0)return;this._handlePointer(e,t)},this);e["_leaflet_touchmove"+n]=i,e.addEventListener(this.POINTER_MOVE,i,!1)},_addPointerEnd:function(e,t,n){var i=r.bind(function(e){this._handlePointer(e,t)},this);e["_leaflet_touchend"+n]=i,e.addEventListener(this.POINTER_UP,i,!1),e.addEventListener(this.POINTER_CANCEL,i,!1)}}),r.Map.mergeOptions({touchZoom:r.Browser.touch&&!r.Browser.android23,bounceAtZoomLimits:!0}),r.Map.TouchZoom=r.Handler.extend({addHooks:function(){r.DomUtil.addClass(this._map._container,"leaflet-touch-zoom"),r.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){r.DomUtil.removeClass(this._map._container,"leaflet-touch-zoom"),r.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(e){var n=this._map;if(!e.touches||e.touches.length!==2||n._animatingZoom||this._zooming)return;var i=n.mouseEventToContainerPoint(e.touches[0]),s=n.mouseEventToContainerPoint(e.touches[1]);this._centerPoint=n.getSize()._divideBy(2),this._startLatLng=n.containerPointToLatLng(this._centerPoint),n.options.touchZoom!=="center"&&(this._pinchStartLatLng=n.containerPointToLatLng(i.add(s)._divideBy(2))),this._startDist=i.distanceTo(s),this._startZoom=n.getZoom(),this._moved=!1,this._zooming=!0,n._stop(),r.DomEvent.on(t,"touchmove",this._onTouchMove,this).on(t,"touchend",this._onTouchEnd,this),r.DomEvent.preventDefault(e)},_onTouchMove:function(e){if(!e.touches||e.touches.length!==2||!this._zooming)return;var t=this._map,n=t.mouseEventToContainerPoint(e.touches[0]),i=t.mouseEventToContainerPoint(e.touches[1]),s=n.distanceTo(i)/this._startDist;this._zoom=t.getScaleZoom(s,this._startZoom),!t.options.bounceAtZoomLimits&&(this._zoom<t.getMinZoom()&&s<1||this._zoom>t.getMaxZoom()&&s>1)&&(this._zoom=t._limitZoom(this._zoom));if(t.options.touchZoom==="center"){this._center=this._startLatLng;if(s===1)return}else{var o=n._add(i)._divideBy(2)._subtract(this._centerPoint);if(s===1&&o.x===0&&o.y===0)return;this._center=t.unproject(t.project(this._pinchStartLatLng,this._zoom).subtract(o),this._zoom)}this._moved||(t._moveStart(!0),this._moved=!0),r.Util.cancelAnimFrame(this._animRequest);var u=r.bind(t._move,t,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=r.Util.requestAnimFrame(u,this,!0),r.DomEvent.preventDefault(e)},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,r.Util.cancelAnimFrame(this._animRequest),r.DomEvent.off(t,"touchmove",this._onTouchMove).off(t,"touchend",this._onTouchEnd),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}}),r.Map.addInitHook("addHandler","touchZoom",r.Map.TouchZoom),r.Map.mergeOptions({tap:!0,tapTolerance:15}),r.Map.Tap=r.Handler.extend({addHooks:function(){r.DomEvent.on(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){r.DomEvent.off(this._map._container,"touchstart",this._onDown,this)},_onDown:function(e){if(!e.touches)return;r.DomEvent.preventDefault(e),this._fireClick=!0;if(e.touches.length>1){this._fireClick=!1,clearTimeout(this._holdTimeout);return}var n=e.touches[0],i=n.target;this._startPos=this._newPos=new r.Point(n.clientX,n.clientY),i.tagName&&i.tagName.toLowerCase()==="a"&&r.DomUtil.addClass(i,"leaflet-active"),this._holdTimeout=setTimeout(r.bind(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",n))},this),1e3),this._simulateEvent("mousedown",n),r.DomEvent.on(t,{touchmove:this._onMove,touchend:this._onUp},this)},_onUp:function(e){clearTimeout(this._holdTimeout),r.DomEvent.off(t,{touchmove:this._onMove,touchend:this._onUp},this);if(this._fireClick&&e&&e.changedTouches){var n=e.changedTouches[0],i=n.target;i&&i.tagName&&i.tagName.toLowerCase()==="a"&&r.DomUtil.removeClass(i,"leaflet-active"),this._simulateEvent("mouseup",n),this._isTapValid()&&this._simulateEvent("click",n)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(e){var t=e.touches[0];this._newPos=new r.Point(t.clientX,t.clientY),this._simulateEvent("mousemove",t)},_simulateEvent:function(n,r){var i=t.createEvent("MouseEvents");i._simulated=!0,r.target._simulatedClick=!0,i.initMouseEvent(n,!0,!0,e,1,r.screenX,r.screenY,r.clientX,r.clientY,!1,!1,!1,!1,0,null),r.target.dispatchEvent(i)}}),r.Browser.touch&&!r.Browser.pointer&&r.Map.addInitHook("addHandler","tap",r.Map.Tap),r.Map.mergeOptions({boxZoom:!0}),r.Map.BoxZoom=r.Handler.extend({initialize:function(e){this._map=e,this._container=e._container,this._pane=e._panes.overlayPane},addHooks:function(){r.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){r.DomEvent.off(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_resetState:function(){this._moved=!1},_onMouseDown:function(e){if(!e.shiftKey||e.which!==1&&e.button!==1)return!1;this._resetState(),r.DomUtil.disableTextSelection(),r.DomUtil.disableImageDrag(),this._startPoint=this._map.mouseEventToContainerPoint(e),r.DomEvent.on(t,{contextmenu:r.DomEvent.stop,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(e){this._moved||(this._moved=!0,this._box=r.DomUtil.create("div","leaflet-zoom-box",this._container),r.DomUtil.addClass(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(e);var t=new r.Bounds(this._point,this._startPoint),n=t.getSize();r.DomUtil.setPosition(this._box,t.min),this._box.style.width=n.x+"px",this._box.style.height=n.y+"px"},_finish:function(){this._moved&&(r.DomUtil.remove(this._box),r.DomUtil.removeClass(this._container,"leaflet-crosshair")),r.DomUtil.enableTextSelection(),r.DomUtil.enableImageDrag(),r.DomEvent.off(t,{contextmenu:r.DomEvent.stop,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(e){if(e.which!==1&&e.button!==1)return;this._finish();if(!this._moved)return;setTimeout(r.bind(this._resetState,this),0);var t=new r.LatLngBounds(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(t).fire("boxzoomend",{boxZoomBounds:t})},_onKeyDown:function(e){e.keyCode===27&&this._finish()}}),r.Map.addInitHook("addHandler","boxZoom",r.Map.BoxZoom),r.Map.mergeOptions({keyboard:!0,keyboardPanDelta:80}),r.Map.Keyboard=r.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(e){this._map=e,this._setPanDelta(e.options.keyboardPanDelta),this._setZoomDelta(e.options.zoomDelta)},addHooks:function(){var e=this._map._container;e.tabIndex<=0&&(e.tabIndex="0"),r.DomEvent.on(e,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),r.DomEvent.off(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(this._focused)return;var n=t.body,r=t.documentElement,i=n.scrollTop||r.scrollTop,s=n.scrollLeft||r.scrollLeft;this._map._container.focus(),e.scrollTo(s,i)},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(e){var t=this._panKeys={},n=this.keyCodes,r,i;for(r=0,i=n.left.length;r<i;r++)t[n.left[r]]=[-1*e,0];for(r=0,i=n.right.length;r<i;r++)t[n.right[r]]=[e,0];for(r=0,i=n.down.length;r<i;r++)t[n.down[r]]=[0,e];for(r=0,i=n.up.length;r<i;r++)t[n.up[r]]=[0,-1*e]},_setZoomDelta:function(e){var t=this._zoomKeys={},n=this.keyCodes,r,i;for(r=0,i=n.zoomIn.length;r<i;r++)t[n.zoomIn[r]]=e;for(r=0,i=n.zoomOut.length;r<i;r++)t[n.zoomOut[r]]=-e},_addHooks:function(){r.DomEvent.on(t,"keydown",this._onKeyDown,this)},_removeHooks:function(){r.DomEvent.off(t,"keydown",this._onKeyDown,this)},_onKeyDown:function(e){if(e.altKey||e.ctrlKey||e.metaKey)return;var t=e.keyCode,n=this._map,i;if(t in this._panKeys){if(n._panAnim&&n._panAnim._inProgress)return;i=this._panKeys[t],e.shiftKey&&(i=r.point(i).multiplyBy(3)),n.panBy(i),n.options.maxBounds&&n.panInsideBounds(n.options.maxBounds)}else if(t in this._zoomKeys)n.setZoom(n.getZoom()+(e.shiftKey?3:1)*this._zoomKeys[t]);else{if(t!==27)return;n.closePopup()}r.DomEvent.stop(e)}}),r.Map.addInitHook("addHandler","keyboard",r.Map.Keyboard),r.Handler.MarkerDrag=r.Handler.extend({initialize:function(e){this._marker=e},addHooks:function(){var e=this._marker._icon;this._draggable||(this._draggable=new r.Draggable(e,e,!0)),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),r.DomUtil.addClass(e,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&r.DomUtil.removeClass(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(e){var t=this._marker,n=t._shadow,i=r.DomUtil.getPosition(t._icon),s=t._map.layerPointToLatLng(i);n&&r.DomUtil.setPosition(n,i),t._latlng=s,e.latlng=s,e.oldLatLng=this._oldLatLng,t.fire("move",e).fire("drag",e)},_onDragEnd:function(e){delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",e)}}),r.Control=r.Class.extend({options:{position:"topright"},initialize:function(e){r.setOptions(this,e)},getPosition:function(){return this.options.position},setPosition:function(e){var t=this._map;return t&&t.removeControl(this),this.options.position=e,t&&t.addControl(this),this},getContainer:function(){return this._container},addTo:function(e){this.remove(),this._map=e;var t=this._container=this.onAdd(e),n=this.getPosition(),i=e._controlCorners[n];return r.DomUtil.addClass(t,"leaflet-control"),n.indexOf("bottom")!==-1?i.insertBefore(t,i.firstChild):i.appendChild(t),this},remove:function(){return this._map?(r.DomUtil.remove(this._container),this.onRemove&&this.onRemove(this._map),this._map=null,this):this},_refocusOnMap:function(e){this._map&&e&&e.screenX>0&&e.screenY>0&&this._map.getContainer().focus()}}),r.control=function(e){return new r.Control(e)},r.Map.include({addControl:function(e){return e.addTo(this),this},removeControl:function(e){return e.remove(),this},_initControlPos:function(){function i(i,s){var o=t+i+" "+t+s;e[i+s]=r.DomUtil.create("div",o,n)}var e=this._controlCorners={},t="leaflet-",n=this._controlContainer=r.DomUtil.create("div",t+"control-container",this._container);i("top","left"),i("top","right"),i("bottom","left"),i("bottom","right")},_clearControlPos:function(){r.DomUtil.remove(this._controlContainer)}}),r.Control.Zoom=r.Control.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"-",zoomOutTitle:"Zoom out"},onAdd:function(e){var t="leaflet-control-zoom",n=r.DomUtil.create("div",t+" leaflet-bar"),i=this.options;return this._zoomInButton=this._createButton(i.zoomInText,i.zoomInTitle,t+"-in",n,this._zoomIn),this._zoomOutButton=this._createButton(i.zoomOutText,i.zoomOutTitle,t+"-out",n,this._zoomOut),this._updateDisabled(),e.on("zoomend zoomlevelschange",this._updateDisabled,this),n},onRemove:function(e){e.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(e){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(e.shiftKey?3:1))},_zoomOut:function(e){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(e.shiftKey?3:1))},_createButton:function(e,t,n,i,s){var o=r.DomUtil.create("a",n,i);return o.innerHTML=e,o.href="#",o.title=t,r.DomEvent.on(o,"mousedown dblclick",r.DomEvent.stopPropagation).on(o,"click",r.DomEvent.stop).on(o,"click",s,this).on(o,"click",this._refocusOnMap,this),o},_updateDisabled:function(){var e=this._map,t="leaflet-disabled";r.DomUtil.removeClass(this._zoomInButton,t),r.DomUtil.removeClass(this._zoomOutButton,t),(this._disabled||e._zoom===e.getMinZoom())&&r.DomUtil.addClass(this._zoomOutButton,t),(this._disabled||e._zoom===e.getMaxZoom())&&r.DomUtil.addClass(this._zoomInButton,t)}}),r.Map.mergeOptions({zoomControl:!0}),r.Map.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new r.Control.Zoom,this.addControl(this.zoomControl))}),r.control.zoom=function(e){return new r.Control.Zoom(e)},r.Control.Attribution=r.Control.extend({options:{position:"bottomright",prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(e){r.setOptions(this,e),this._attributions={}},onAdd:function(e){e.attributionControl=this,this._container=r.DomUtil.create("div","leaflet-control-attribution"),r.DomEvent&&r.DomEvent.disableClickPropagation(this._container);for(var t in e._layers)e._layers[t].getAttribution&&this.addAttribution(e._layers[t].getAttribution());return this._update(),this._container},setPrefix:function(e){return this.options.prefix=e,this._update(),this},addAttribution:function(e){return e?(this._attributions[e]||(this._attributions[e]=0),this._attributions[e]++,this._update(),this):this},removeAttribution:function(e){return e?(this._attributions[e]&&(this._attributions[e]--,this._update()),this):this},_update:function(){if(!this._map)return;var e=[];for(var t in this._attributions)this._attributions[t]&&e.push(t);var n=[];this.options.prefix&&n.push(this.options.prefix),e.length&&n.push(e.join(", ")),this._container.innerHTML=n.join(" | ")}}),r.Map.mergeOptions({attributionControl:!0}),r.Map.addInitHook(function(){this.options.attributionControl&&(new r.Control.Attribution).addTo(this)}),r.control.attribution=function(e){return new r.Control.Attribution(e)},r.Control.Scale=r.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(e){var t="leaflet-control-scale",n=r.DomUtil.create("div",t),i=this.options;return this._addScales(i,t+"-line",n),e.on(i.updateWhenIdle?"moveend":"move",this._update,this),e.whenReady(this._update,this),n},onRemove:function(e){e.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(e,t,n){e.metric&&(this._mScale=r.DomUtil.create("div",t,n)),e.imperial&&(this._iScale=r.DomUtil.create("div",t,n))},_update:function(){var e=this._map,t=e.getSize().y/2,n=e.distance(e.containerPointToLatLng([0,t]),e.containerPointToLatLng([this.options.maxWidth,t]));this._updateScales(n)},_updateScales:function(e){this.options.metric&&e&&this._updateMetric(e),this.options.imperial&&e&&this._updateImperial(e)},_updateMetric:function(e){var t=this._getRoundNum(e),n=t<1e3?t+" m":t/1e3+" km";this._updateScale(this._mScale,n,t/e)},_updateImperial:function(e){var t=e*3.2808399,n,r,i;t>5280?(n=t/5280,r=this._getRoundNum(n),this._updateScale(this._iScale,r+" mi",r/n)):(i=this._getRoundNum(t),this._updateScale(this._iScale,i+" ft",i/t))},_updateScale:function(e,t,n){e.style.width=Math.round(this.options.maxWidth*n)+"px",e.innerHTML=t},_getRoundNum:function(e){var t=Math.pow(10,(Math.floor(e)+"").length-1),n=e/t;return n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:1,t*n}}),r.control.scale=function(e){return new r.Control.Scale(e)},r.Control.Layers=r.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1},initialize:function(e,t,n){r.setOptions(this,n),this._layers=[],this._lastZIndex=0,this._handlingClick=!1;for(var i in e)this._addLayer(e[i],i);for(i in t)this._addLayer(t[i],i,!0)},onAdd:function(e){return this._initLayout(),this._update(),this._map=e,e.on("zoomend",this._checkDisabledLayers,this),this._container},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var e=0;e<this._layers.length;e++)this._layers[e].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(e,t){return this._addLayer(e,t),this._map?this._update():this},addOverlay:function(e,t){return this._addLayer(e,t,!0),this._map?this._update():this},removeLayer:function(e){e.off("add remove",this._onLayerChange,this);var t=this._getLayer(r.stamp(e));return t&&this._layers.splice(this._layers.indexOf(t),1),this._map?this._update():this},expand:function(){r.DomUtil.addClass(this._container,"leaflet-control-layers-expanded"),this._form.style.height=null;var e=this._map.getSize().y-(this._container.offsetTop+50);return e<this._form.clientHeight?(r.DomUtil.addClass(this._form,"leaflet-control-layers-scrollbar"),this._form.style.height=e+"px"):r.DomUtil.removeClass(this._form,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return r.DomUtil.removeClass(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var e="leaflet-control-layers",t=this._container=r.DomUtil.create("div",e);t.setAttribute("aria-haspopup",!0),r.DomEvent.disableClickPropagation(t),r.Browser.touch||r.DomEvent.disableScrollPropagation(t);var n=this._form=r.DomUtil.create("form",e+"-list");if(this.options.collapsed){r.Browser.android||r.DomEvent.on(t,{mouseenter:this.expand,mouseleave:this.collapse},this);var i=this._layersLink=r.DomUtil.create("a",e+"-toggle",t);i.href="#",i.title="Layers",r.Browser.touch?r.DomEvent.on(i,"click",r.DomEvent.stop).on(i,"click",this.expand,this):r.DomEvent.on(i,"focus",this.expand,this),r.DomEvent.on(n,"click",function(){setTimeout(r.bind(this._onInputClick,this),0)},this),this._map.on("click",this.collapse,this)}else this.expand();this._baseLayersList=r.DomUtil.create("div",e+"-base",n),this._separator=r.DomUtil.create("div",e+"-separator",n),this._overlaysList=r.DomUtil.create("div",e+"-overlays",n),t.appendChild(n)},_getLayer:function(e){for(var t=0;t<this._layers.length;t++)if(this._layers[t]&&r.stamp(this._layers[t].layer)===e)return this._layers[t]},_addLayer:function(e,t,n){e.on("add remove",this._onLayerChange,this),this._layers.push({layer:e,name:t,overlay:n}),this.options.autoZIndex&&e.setZIndex&&(this._lastZIndex++,e.setZIndex(this._lastZIndex))},_update:function(){if(!this._container)return this;r.DomUtil.empty(this._baseLayersList),r.DomUtil.empty(this._overlaysList);var e,t,n,i,s=0;for(n=0;n<this._layers.length;n++)i=this._layers[n],this._addItem(i),t=t||i.overlay,e=e||!i.overlay,s+=i.overlay?0:1;return this.options.hideSingleBase&&(e=e&&s>1,this._baseLayersList.style.display=e?"":"none"),this._separator.style.display=t&&e?"":"none",this},_onLayerChange:function(e){this._handlingClick||this._update();var t=this._getLayer(r.stamp(e.target)),n=t.overlay?e.type==="add"?"overlayadd":"overlayremove":e.type==="add"?"baselayerchange":null;n&&this._map.fire(n,t)},_createRadioElement:function(e,n){var r='<input type="radio" class="leaflet-control-layers-selector" name="'+e+'"'+(n?' checked="checked"':"")+"/>",i=t.createElement("div");return i.innerHTML=r,i.firstChild},_addItem:function(e){var n=t.createElement("label"),i=this._map.hasLayer(e.layer),s;e.overlay?(s=t.createElement("input"),s.type="checkbox",s.className="leaflet-control-layers-selector",s.defaultChecked=i):s=this._createRadioElement("leaflet-base-layers",i),s.layerId=r.stamp(e.layer),r.DomEvent.on(s,"click",this._onInputClick,this);var o=t.createElement("span");o.innerHTML=" "+e.name;var u=t.createElement("div");n.appendChild(u),u.appendChild(s),u.appendChild(o);var a=e.overlay?this._overlaysList:this._baseLayersList;return a.appendChild(n),this._checkDisabledLayers(),n},_onInputClick:function(){var e=this._form.getElementsByTagName("input"),t,n,r,i=[],s=[];this._handlingClick=!0;for(var o=e.length-1;o>=0;o--)t=e[o],n=this._getLayer(t.layerId).layer,r=this._map.hasLayer(n),t.checked&&!r?i.push(n):!t.checked&&r&&s.push(n);for(o=0;o<s.length;o++)this._map.removeLayer(s[o]);for(o=0;o<i.length;o++)this._map.addLayer(i[o]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){var e=this._form.getElementsByTagName("input"),t,r,i=this._map.getZoom();for(var s=e.length-1;s>=0;s--)t=e[s],r=this._getLayer(t.layerId).layer,t.disabled=r.options.minZoom!==n&&i<r.options.minZoom||r.options.maxZoom!==n&&i>r.options.maxZoom},_expand:function(){return this.expand()},_collapse:function(){return this.collapse()}}),r.control.layers=function(e,t,n){return new r.Control.Layers(e,t,n)},r.PosAnimation=r.Evented.extend({run:function(e,t,n,i){this.stop(),this._el=e,this._inProgress=!0,this._duration=n||.25,this._easeOutPower=1/Math.max(i||.5,.2),this._startPos=r.DomUtil.getPosition(e),this._offset=t.subtract(this._startPos),this._startTime=+(new Date),this.fire("start"),this._animate()},stop:function(){if(!this._inProgress)return;this._step(!0),this._complete()},_animate:function(){this._animId=r.Util.requestAnimFrame(this._animate,this),this._step()},_step:function(e){var t=+(new Date)-this._startTime,n=this._duration*1e3;t<n?this._runFrame(this._easeOut(t/n),e):(this._runFrame(1),this._complete())},_runFrame:function(e,t){var n=this._startPos.add(this._offset.multiplyBy(e));t&&n._round(),r.DomUtil.setPosition(this._el,n),this.fire("step")},_complete:function(){r.Util.cancelAnimFrame(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(e){return 1-Math.pow(1-e,this._easeOutPower)}}),r.Map.include({setView:function(e,t,i){t=t===n?this._zoom:this._limitZoom(t),e=this._limitCenter(r.latLng(e),t,this.options.maxBounds),i=i||{},this._stop();if(this._loaded&&!i.reset&&i!==!0){i.animate!==n&&(i.zoom=r.extend({animate:i.animate},i.zoom),i.pan=r.extend({animate:i.animate,duration:i.duration},i.pan));var s=this._zoom!==t?this._tryAnimatedZoom&&this._tryAnimatedZoom(e,t,i.zoom):this._tryAnimatedPan(e,i.pan);if(s)return clearTimeout(this._sizeTimer),this}return this._resetView(e,t),this},panBy:function(e,t){e=r.point(e).round(),t=t||{};if(!e.x&&!e.y)return this.fire("moveend");if(t.animate!==!0&&!this.getSize().contains(e))return this._resetView(this.unproject(this.project(this.getCenter()).add(e)),this.getZoom()),this;this._panAnim||(this._panAnim=new r.PosAnimation,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),t.noMoveStart||this.fire("movestart");if(t.animate!==!1){r.DomUtil.addClass(this._mapPane,"leaflet-pan-anim");var n=this._getMapPanePos().subtract(e).round();this._panAnim.run(this._mapPane,n,t.duration||.25,t.easeLinearity)}else this._rawPanBy(e),this.fire("move").fire("moveend");return this},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){r.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(e,t){var n=this._getCenterOffset(e)._floor();return(t&&t.animate)!==!0&&!this.getSize().contains(n)?!1:(this.panBy(n,t),!0)}}),r.Map.mergeOptions({zoomAnimation:!0,zoomAnimationThreshold:4});var a=r.DomUtil.TRANSITION&&r.Browser.any3d&&!r.Browser.mobileOpera;a&&r.Map.addInitHook(function(){this._zoomAnimated=this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),r.DomEvent.on(this._proxy,r.DomUtil.TRANSITION_END,this._catchTransitionEnd,this))}),r.Map.include(a?{_createAnimProxy:function(){var e=this._proxy=r.DomUtil.create("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(e),this.on("zoomanim",function(t){var n=r.DomUtil.TRANSFORM,i=e.style[n];r.DomUtil.setTransform(e,this.project(t.center,t.zoom),this.getZoomScale(t.zoom,1)),i===e.style[n]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",function(){var t=this.getCenter(),n=this.getZoom();r.DomUtil.setTransform(e,this.project(t,n),this.getZoomScale(n,1))},this)},_catchTransitionEnd:function(e){this._animatingZoom&&e.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(e,t,n){if(this._animatingZoom)return!0;n=n||{};if(!this._zoomAnimated||n.animate===!1||this._nothingToAnimate()||Math.abs(t-this._zoom)>this.options.zoomAnimationThreshold)return!1;var i=this.getZoomScale(t),s=this._getCenterOffset(e)._divideBy(1-1/i);return n.animate!==!0&&!this.getSize().contains(s)?!1:(r.Util.requestAnimFrame(function(){this._moveStart(!0)._animateZoom(e,t,!0)},this),!0)},_animateZoom:function(e,t,n,i){n&&(this._animatingZoom=!0,this._animateToCenter=e,this._animateToZoom=t,r.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:e,zoom:t,noUpdate:i}),setTimeout(r.bind(this._onZoomTransitionEnd,this),250)},_onZoomTransitionEnd:function(){if(!this._animatingZoom)return;r.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom),r.Util.requestAnimFrame(function(){this._moveEnd(!0)},this)}}:{}),r.Map.include({flyTo:function(e,t,i){function d(e){var t=e?-1:1,n=e?l:f,r=l*l-f*f+t*p*p*c*c,i=2*n*p*c,s=r/i,o=Math.sqrt(s*s+1)-s,u=o<1e-9?-18:Math.log(o);return u}function v(e){return(Math.exp(e)-Math.exp(-e))/2}function m(e){return(Math.exp(e)+Math.exp(-e))/2}function g(e){return v(e)/m(e)}function b(e){return f*(m(y)/m(y+h*e))}function w(e){return f*(m(y)*g(y+h*e)-v(y))/p}function E(e){return 1-Math.pow(1-e,1.5)}function N(){var n=(Date.now()-S)/T,i=E(n)*x;n<=1?(this._flyToFrame=r.Util.requestAnimFrame(N,this),this._move(this.unproject(s.add(o.subtract(s).multiplyBy(w(i)/c)),a),this.getScaleZoom(f/b(i),a),{flyTo:!0})):this._move(e,t)._moveEnd(!0)}i=i||{};if(i.animate===!1||!r.Browser.any3d)return this.setView(e,t,i);this._stop();var s=this.project(this.getCenter()),o=this.project(e),u=this.getSize(),a=this._zoom;e=r.latLng(e),t=t===n?a:t;var f=Math.max(u.x,u.y),l=f*this.getZoomScale(a,t),c=o.distanceTo(s)||1,h=1.42,p=h*h,y=d(0),S=Date.now(),x=(d(1)-y)/h,T=i.duration?1e3*i.duration:1e3*x*.8;return this._moveStart(!0),N.call(this),this},flyToBounds:function(e,t){var n=this._getBoundsCenterZoom(e,t);return this.flyTo(n.center,n.zoom,t)}}),r.Map.include({_defaultLocateOptions:{timeout:1e4,watch:!1},locate:function(e){e=this._locateOptions=r.extend({},this._defaultLocateOptions,e);if("geolocation"in navigator){var t=r.bind(this._handleGeolocationResponse,this),n=r.bind(this._handleGeolocationError,this);return e.watch?this._locationWatchId=navigator.geolocation.watchPosition(t,n,e):navigator.geolocation.getCurrentPosition(t,n,e),this}return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(e){var t=e.code,n=e.message||(t===1?"permission denied":t===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:t,message:"Geolocation error: "+n+"."})},_handleGeolocationResponse:function(e){var t=e.coords.latitude,n=e.coords.longitude,i=new r.LatLng(t,n),s=i.toBounds(e.coords.accuracy),o=this._locateOptions;if(o.setView){var u=this.getBoundsZoom(s);this.setView(i,o.maxZoom?Math.min(u,o.maxZoom):u)}var a={latlng:i,bounds:s,timestamp:e.timestamp};for(var f in e.coords)typeof e.coords[f]=="number"&&(a[f]=e.coords[f]);this.fire("locationfound",a)}})})(window,document);