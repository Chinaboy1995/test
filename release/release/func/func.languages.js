define("func/languages",["leaflet","func/base","plugins/jqueryi18n"],function(){L.ICT.Func.add("Languages",{Class:L.Class.extend({initialize:function(){this._container=L.ict.app.toppanel.getContainer(),this.config=Project_ParamConfig.languages,this.localStorage=L.ict.app.localStorage,this.lang=this.localStorage.getItem("language")||"zh"},start:function(){this.initi18n(),this.initLang(),this.initEvts()},stop:function(){},initi18n:function(){var e=this,t=this.lang==="zh"?"":this.lang;$.i18n.properties({name:"strings",path:"languages/",mode:"both",language:t,cache:!0,checkAvailableLanguages:!0,async:!1,callback:function(){e.langLoadCallback()}})},initLang:function(){var e=[];for(var t=0,n=this.config.length;t<n;t++){var r=this.config[t];this.lang===r.key?this.lang==="zh"?e.push('<option selected value="'+r.key+'">'+r.value+"</option>"):e.push('<option selected value="'+r.key+'">'+r.value_en+"</option>"):this.lang==="zh"?e.push('<option value="'+r.key+'">'+r.value+"</option>"):e.push('<option value="'+r.key+'">'+r.value_en+"</option>")}e=e.join(""),this.localStorage.setItem("language",this.lang),this._container.find(".languageSetting").html(e)},initEvts:function(){var e=this;this._container.find(".languageSetting").on("change",function(t){var n=$(this).val();e.localStorage.setItem("language",n),window.location.reload()})},langLoadCallback:function(){this.loadMainPageLang(),this.loadFuncPageLang()},loadMainPageLang:function(){document.title=$.i18n.prop("systemname"),this._toppanel=L.ict.app.toppanel.getContainer(),this._toppanel.find(".toppanel_left_title").html($.i18n.prop("toppanel_left_title")),this._toppanel.find(".toppanel_keysearch_remind").attr("placeholder",$.i18n.prop("func_keysearch_ship_plh")),this._toppanel.find(".toppanel_keysearch_title").attr("title",$.i18n.prop("toppanel_keysearch_title")),this._toppanel.find(".toppanel_right_eventRemind").html($.i18n.prop("toppanel_right_eventRemind")),this._toppanel.find(".toppanel_right_layerSelect").html($.i18n.prop("toppanel_right_layerSelect")),this._toppanel.find(".toppanel_right_langSetting").html($.i18n.prop("toppanel_right_langSetting")),this._toppanel.find(".toppanel_right_login").html($.i18n.prop("toppanel_right_login")),this._toppanel.find(".toppanel_right_enroll").html($.i18n.prop("toppanel_right_enroll")),this._toppanel.find(".toppanel_right_signout").html($.i18n.prop("toppanel_right_signout")),this._toppanel.find(".toppanel_right_changepsw").html($.i18n.prop("toppanel_right_changepsw"))},loadFuncPageLang:function(){}})})});