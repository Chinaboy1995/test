define("util/tool",["leaflet","plugins/proj4js","core/namespace"],function(e,t){e.ICT.Util.Tool=e.Class.extend({initialize:function(){},drag:function(t,n){var r=!1,i,s,o=$("#"+n),u=$("#"+t),a="drag_"+e.stamp(u);o.data("drag","drag"),o.data("panel",a),u.addClass(a),this.initDrag||(this.initDrag=!0,$(document).mousedown(function(t){u=null,o=null,o=$(t.target),o=o.data("drag")?o:o.parent();if(!o.data("drag")||o.data("drag")!="drag"||!o.data("panel"))return;r=!0,u=o.closest("."+o.data("panel"));if(u.length==0)return;u=u[0],i=t.clientX,s=t.clientY;var n=e.DomUtil.getPosition(u);return n&&(i-=n.x,s-=n.y),!1}),$(document).mousemove(function(t){if(r&&u){var t=t||window.event,n=t.clientX-i,o=t.clientY-s,a=e.point(n,o);return e.DomUtil.setPosition(u,a),!1}}),$(document).mouseup(function(e){r=!1,i=null,s=null,o=null,u=null,a=null}))},latlngTodfm:function(e,t,n,r){var i=[],s;newval=parseFloat(e);var o=Math.abs(newval),u=parseInt(o),a=parseInt(o*60)-u*60,f=o*60*60-a*60-u*60*60;if(typeof r=="undefined"||r<=0)r=0;return f=f.toFixed(r),typeof n=="undefined"&&(n=!0),n&&(t==="lng"?(u<10&&(u="00"+u),u>=10&&u<100&&(u="0"+u)):u<10&&(u="0"+u)),t==="lat"&&(newval<0?s="S":s="N"),t==="lng"&&(newval<0?s="W":s="E"),i.push(u,a,f,s),i},latlngTodfmStr:function(e,t,n){var r=this.latlngTodfm(e,t,n),i=r[3]+" "+r[0]+"°"+r[1]+"′"+r[2]+"″";return i},formatStr:function(e,t){if(e.indexOf(".")>=0){var n=e.length,r=n-e.indexOf("."),i=r-1;if(i<=t)return e;var s=e.indexOf(".")+t+1;return e.substr(0,s)}return e},formatLng:function(e){return e<10?"00"+e:e<100?"0"+e:e},formatLat:function(e){return e<10?"0"+e:e},convertMileToNmile:function(e){var t=parseFloat(e),n=t*54e-5;return n.toFixed(3)},convertNmileToMile:function(e){var t=parseFloat(e),n=t/54e-5;return n.toFixed(3)},epsg4326To3857:function(e,n){return t("EPSG:4326","EPSG:3857",[e,n])},epsg4326To3395:function(e,n){return t.defs("EPSG:3395","+proj=merc +lon_0=0 +k=1 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs"),t("EPSG:4326","EPSG:3395",[e,n])},invoke:function(e,t,n,r){t||(t=0);if(arguments.length<=2)setTimeout(e,t);else{setTimeout(i,t);function i(){var t=setInterval(e,n);r&&setTimeout(function(){clearInterval(t)},r)}}}})});