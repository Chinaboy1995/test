define("plugins/ajaxpoll",["jquery"],function(){(function(e){var t,n,r,i,s=function(o){function u(){return document.hidden||document.mozHidden||document.msHidden||document.webkitHidden||!1}function a(e){var t=u()?a:s;n&&clearTimeout(n),n=setTimeout(function(){t(e)},1e3)}function f(e){return Math.round(Math.random()*500*Math.pow(2,e))}function l(e,t){var o=u()?a:s;n&&clearTimeout(n);if(i>e.pollMaxFailedAttempts){console.error("Polling terminated due to exceeding max failed attempts...");return}if(e.pollLoops!==-1){r+=1;if(r>=e.pollLoops)return}t&&(n=setTimeout(function(){o(e)},t))}var c=e.ajax;o.pollDelay=o.pollDelay||6e4,o.pollLoops=o.pollLoops||-1,o.pollMaxFailedAttempts=o.pollMaxFailedAttempts||10,r=r||0,i=i||0,t=c(o),typeof o.pollDone=="function"&&t.done(o.pollDone),typeof o.pollFail=="function"&&t.fail(o.pollFail),t.done(function(){i=0,l(o,o.pollDelay)}),t.fail(function(){i++,l(o,f(i))})};e.extend({poll:s})})(jQuery)});