/*
 * My97 DatePicker 4.8 Beta2
 * License: http://www.my97.net/dp/license.asp
 */

var $dp,WdatePicker;(function(){function e(){w.$dp=w.$dp||{},obj={$:function(e){return typeof e=="string"?v[g].getElementById(e):e},$D:function(e,t){return this.$DV(this.$(e).value,t)},$DV:function(e,t){if(e!=""){this.dt=$dp.cal.splitDate(e,$dp.cal.dateFmt);if(t)for(var n in t)if(this.dt[n]===undefined)this.errMsg="invalid property:"+n;else{this.dt[n]+=t[n];if(n=="M"){var r=t.M>0?1:0,i=(new Date(this.dt.y,this.dt.M,0)).getDate();this.dt.d=Math.min(i+r,this.dt.d)}}if(this.dt.refresh())return this.dt}return""},show:function(){var e=w[g].getElementsByTagName("div"),t=1e5;for(var n=0;n<e.length;n++){var r=parseInt(e[n].style.zIndex);r>t&&(t=r)}this.dd.style.zIndex=t+2,h(this.dd,"block")},hide:function(){h(this.dd,"none")},attachEvent:t};for(var e in obj)w.$dp[e]=obj[e];$dp=w.$dp}function t(e,t,n){if(S)e.attachEvent(t,n);else if(n){var r=t.replace(/on/,"");n._ieEmuEventHandler=function(e){return n(e)},e.addEventListener(r,n._ieEmuEventHandler,!1)}}function n(){var e,t,n=v[g][b]("script");for(var r=0;r<n.length;r++){e=n[r].getAttribute("src")||"",e=e.substr(0,e.toLowerCase().indexOf("wdatepicker.js")),t=e.lastIndexOf("/"),t>0&&(e=e.substring(0,t+1));if(e)break}return e}function r(e,t,n){var r=v[g][b]("HEAD").item(0),i=v[g].createElement("link");r&&(i.href=e,i.rel="stylesheet",i.type="text/css",t&&(i.title=t),n&&(i.charset=n),r.appendChild(i))}function i(e){e=e||w;var t=0,n=0;while(e!=w){var r=e.parent[g][b]("iframe");for(var i=0;i<r.length;i++)try{if(r[i].contentWindow==e){var o=s(r[i]);t+=o.left,n+=o.top;break}}catch(u){}e=e.parent}return{leftM:t,topM:n}}function s(e,t){if(e.getBoundingClientRect)return e.getBoundingClientRect();var n={ROOT_TAG:/^body|html$/i,OP_SCROLL:/^(?:inline|table-row)$/i},r=!1,i=null,s=e.offsetTop,o=e.offsetLeft,a=e.offsetWidth,f=e.offsetHeight,l=e.offsetParent;if(l!=e)while(l)o+=l.offsetLeft,s+=l.offsetTop,c(l,"position").toLowerCase()=="fixed"?r=!0:l.tagName.toLowerCase()=="body"&&(i=l.ownerDocument.defaultView),l=l.offsetParent;l=e.parentNode;while(l.tagName&&!n.ROOT_TAG.test(l.tagName))(l.scrollTop||l.scrollLeft)&&!n.OP_SCROLL.test(h(l))&&(!T||l.style.overflow!=="visible")&&(o-=l.scrollLeft,s-=l.scrollTop),l=l.parentNode;if(!r){var p=u(i);o-=p.left,s-=p.top}return a+=o,f+=s,{left:o,top:s,right:a,bottom:f}}function o(e){e=e||w;var t=e[g],n=e.innerWidth?e.innerWidth:t[y]&&t[y].clientWidth?t[y].clientWidth:t.body.offsetWidth,r=e.innerHeight?e.innerHeight:t[y]&&t[y].clientHeight?t[y].clientHeight:t.body.offsetHeight;return{width:n,height:r}}function u(e){e=e||w;var t=e[g],n=t[y],r=t.body;return t=n&&n.scrollTop!=null&&(n.scrollTop>r.scrollTop||n.scrollLeft>r.scrollLeft)?n:r,{top:t.scrollTop,left:t.scrollLeft}}function a(e){var t=e?e.srcElement||e.target:null;try{$dp.cal&&!$dp.eCont&&$dp.dd&&t!=$dp.el&&$dp.dd.style.display=="block"&&$dp.cal.close()}catch(e){}}function f(){$dp.status=2}function l(n,r){function i(){return S&&w!=v&&w[g].readyState!="complete"?!1:!0}function s(){if(x){func=s.caller;while(func!=null){var e=func.arguments[0];if(e&&(e+"").indexOf("Event")>=0)return e;func=func.caller}return null}return event}$dp.win=v,e(),n=n||{};for(var o in d)o.substring(0,1)!="$"&&n[o]===undefined&&(n[o]=d[o]);if(r){if(!i()){L=L||setInterval(function(){w[g].readyState=="complete"&&clearInterval(L),l(null,!0)},50);return}if($dp.status!=0)return;$dp.status=1,n.el=m,p(n,!0)}else if(n.eCont)n.eCont=$dp.$(n.eCont),n.el=m,n.autoPickDate=!0,n.qsEnabled=!1,p(n);else{if(d.$preLoad&&$dp.status!=2)return;var u=s();u&&(n.srcEl=u.srcElement||u.target,u.cancelBubble=!0),n.el=n.el=$dp.$(n.el||n.srcEl);if(!n.el||n.el.My97Mark===!0||n.el.disabled||$dp.dd&&h($dp.dd)!="none"&&$dp.dd.style.left!="-970px"){try{n.el.My97Mark=!1}catch(a){}return}p(n);if(u&&n.el.nodeType==1&&n.el.My97Mark===undefined){var f,c;u.type=="focus"?(f="onclick",c="onfocus"):(f="onfocus",c="onclick"),t(n.el,f,n.el[c])}}}function c(e,t){return e.currentStyle?e.currentStyle[t]:document.defaultView.getComputedStyle(e,!1)[t]}function h(e,t){if(e){if(t==null)return c(e,"display");e.style.display=t}}function p(e,t){function n(e,t){e.innerHTML="<iframe hideFocus=true width=97 height=9 frameborder=0 border=0 scrolling=no></iframe>";var n=e.lastChild.contentWindow[g],i=d.$langList,s=d.$skinList,o=t.getRealLang();e.lang=o.name,e.skin=t.skin;var u=["<head><script>","var $d, $dp, $cfg=document.cfg, $pdp = parent.$dp, $dt, $tdt, $sdt, $lastInput, $IE=$pdp.ie, $FF = $pdp.ff,$OPERA=$pdp.opera, $ny, $cMark = false;","if($cfg.eCont){$dp = {};for(var p in $pdp)$dp[p]=$pdp[p];}else{$dp=$pdp;};for(var p in $cfg){$dp[p]=$cfg[p];}","document.oncontextmenu=function(){try{$c._fillQS(!$dp.has.d,1);showB($d.qsDivSel);}catch(e){};return false;};","</script><script src=",E,"lang/",o.name,".js charset=",o.charset,"></script>"];for(var a=0;a<s.length;a++)s[a].name==t.skin&&u.push('<link rel="stylesheet" type="text/css" href="'+E+"skin/"+s[a].name+'/datepicker.css" charset="'+s[a].charset+'"/>');u.push('<script type="text/javascript" src="'+E+'calendar.js?"+Math.random()+" charset="gb2312"></script>'),u.push('</head><body leftmargin="0" topmargin="0" tabindex=0></body></html>'),u.push("<script>var t;t=t||setInterval(function(){if(document.ready){new My97DP();$cfg.onload();$c.autoSize();$cfg.setPos($dp);clearInterval(t);}},20);if($FF||$OPERA)document.close();</script>"),t.setPos=r,t.onload=f,n.write("<html>"),n.cfg=t,n.write(u.join(""))}function r(e){var t=e.position.left,n=e.position.top,r=e.el;if(r==m)return;r!=e.srcEl&&(h(r)=="none"||r.type=="hidden")&&(r=e.srcEl);var a=s(r),f=i(v),l=o(w),c=u(w),p=$dp.dd.offsetHeight,d=$dp.dd.offsetWidth;isNaN(n)&&(n=0),f.topM+a.bottom+p>l.height&&f.topM+a.top-p>0?n+=c.top+f.topM+a.top-p-2:n+=c.top+f.topM+Math.min(a.bottom,l.height-p)+2,isNaN(t)&&(t=0),t+=c.left+Math.min(f.leftM+a.left,l.width-d-5)-(S?2:0),e.dd.style.top=n+"px",e.dd.style.left=t+"px"}var a=e.el?e.el.nodeName:"INPUT";if(!(t||e.eCont||(new RegExp(/input|textarea|div|span|p|a/ig)).test(a)))return;e.elProp=a=="INPUT"?"value":"innerHTML",e.lang=="auto"&&(e.lang=S?navigator.browserLanguage.toLowerCase():navigator.language.toLowerCase());if(!e.eCont)for(var l in e)$dp[l]=e[l];!$dp.dd||e.eCont||$dp.dd&&(e.getRealLang().name!=$dp.dd.lang||e.skin!=$dp.dd.skin)?e.eCont?n(e.eCont,e):($dp.dd=w[g].createElement("DIV"),$dp.dd.style.cssText="position:absolute",w[g].body.appendChild($dp.dd),n($dp.dd,e),t?$dp.dd.style.left=$dp.dd.style.top="-970px":($dp.show(),r($dp))):$dp.cal&&($dp.show(),$dp.cal.init(),$dp.eCont||r($dp))}var d={$langList:[{name:"en",charset:"UTF-8"},{name:"zh-cn",charset:"UTF-8"},{name:"zh-tw",charset:"UTF-8"}],$skinList:[{name:"default",charset:"gb2312"},{name:"whyGreen",charset:"gb2312"},{name:"twoer",charset:"gb2312"}],$wdate:!0,$crossFrame:!0,$preLoad:!1,doubleCalendar:!1,enableKeyboard:!0,enableInputMask:!0,autoUpdateOnChanged:null,weekMethod:"ISO8601",position:{},lang:"auto",skin:"twoer",dateFmt:"yyyy-MM-dd",realDateFmt:"yyyy-MM-dd",realTimeFmt:"HH:mm:ss",realFullFmt:"%Date %Time",minDate:"1900-01-01 00:00:00",maxDate:"2099-12-31 23:59:59",startDate:"",alwaysUseStartDate:!1,yearOffset:1911,firstDayOfWeek:0,isShowWeek:!1,highLineWeekDay:!0,isShowClear:!0,isShowToday:!0,isShowOK:!0,isShowOthers:!0,readOnly:!1,errDealMode:0,autoPickDate:null,qsEnabled:!0,autoShowQS:!1,specialDates:null,specialDays:null,disabledDates:null,disabledDays:null,opposite:!1,onpicking:null,onpicked:null,onclearing:null,oncleared:null,ychanging:null,ychanged:null,Mchanging:null,Mchanged:null,dchanging:null,dchanged:null,Hchanging:null,Hchanged:null,mchanging:null,mchanged:null,schanging:null,schanged:null,eCont:null,vel:null,elProp:"",errMsg:"",quickSel:[],has:{},getRealLang:function(){var e=d.$langList;for(var t=0;t<e.length;t++)if(e[t].name==this.lang)return e[t];return e[0]}};WdatePicker=l;var v=window,m={innerHTML:""},g="document",y="documentElement",b="getElementsByTagName",w,E,S,x,T,N=navigator.appName;N=="Microsoft Internet Explorer"?S=!0:N=="Opera"?T=!0:x=!0,E=n(),d.$wdate&&r(E+"skin/WdatePicker.css"),w=v;if(d.$crossFrame)try{while(w.parent&&w.parent[g]!=w[g]&&w.parent[g][b]("frameset").length==0)w=w.parent}catch(C){}w.$dp||(w.$dp={ff:x,ie:S,opera:T,status:0,defMinDate:d.minDate,defMaxDate:d.maxDate}),e(),d.$preLoad&&$dp.status==0&&t(v,"onload",function(){l(null,!0)}),v[g].docMD||(t(v[g],"onmousedown",a),v[g].docMD=!0),w[g].docMD||(t(w[g],"onmousedown",a),w[g].docMD=!0),t(v,"onunload",function(){$dp.dd&&h($dp.dd,"none")});var k,L})();